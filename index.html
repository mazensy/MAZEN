<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MAZEN </title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700;900&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#05050b;
  --panel:#0b1220;
  --muted:#98a6bf;
  --text:#eaf3ff;
  --accent1:#2b82ff;
  --accent2:#7a3cff;
  --accent-cta:#ffd166;
  --glass: rgba(255,255,255,0.03);
  --card-glow: 0 10px 40px rgba(58,88,255,0.12);
  --neon: 0 6px 20px rgba(123,60,255,0.12);
  --shadow: rgba(2,6,23,0.6);
  --success: #22c55e;
  --card-bg: #0f172a;
  --border-color: rgba(255,255,255,0.08);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font-family:"Tajawal",sans-serif; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  background:
    radial-gradient(800px 400px at 8% 12%, rgba(43,130,255,0.03), transparent),
    radial-gradient(600px 300px at 92% 88%, rgba(122,60,255,0.02), transparent),
    var(--bg);
  color:var(--text); overflow-x:hidden;
}
.header{
  position:sticky; top:0; z-index:1000;
  display:flex; align-items:center; justify-content:space-between;
  gap:12px; padding:14px 18px;
  backdrop-filter: blur(10px);
  background: rgba(5, 5, 11, 0.8);
  border-bottom: 1px solid var(--border-color);
  transition:background .28s ease;
}
.header.scrolled{ background: rgba(5, 5, 11, 0.95); }
.logo{display:flex; align-items:center; gap:12px}
.sym{width:48px; height:48px; border-radius:12px; display:flex; align-items:center; justify-content:center; font-weight:900; font-size:20px; color:#fff; background:linear-gradient(135deg,var(--accent1),var(--accent2)); box-shadow:var(--neon)}
.brand{font-weight:900; font-size:18px;}
.tag{color:var(--muted); font-size:12px}
.container{max-width:1200px; margin:30px auto; padding:0 18px}
.hero{display:flex; justify-content:space-between; gap:20px; align-items:center; flex-wrap:wrap; margin-bottom:20px; padding:20px 0;}
.hero h1{margin:0; font-size:28px; font-weight:900;}
.hero p{margin:8px 0 0 0; color:var(--muted); font-size:15px}
.top-offer{
  display:flex; gap:12px; align-items:center; padding:12px 18px; border-radius:12px;
  background: linear-gradient(90deg,rgba(255,209,102,0.1),rgba(122,60,255,0.1));
  border:1px solid rgba(255,209,102,0.2); color:var(--text);
  font-weight:700; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}
.top-offer small{color:var(--accent-cta); font-weight:600}
.controls{display:flex; gap:16px; align-items:center; flex-wrap:wrap; margin-bottom:20px; padding:10px 0; border-bottom:1px solid var(--border-color);}
.category-bar{display:flex; gap:10px; flex-wrap:wrap}
.cat-btn{
  display:inline-flex; align-items:center; gap:8px; padding:10px 16px; border-radius:10px; cursor:pointer; border:1px solid var(--border-color);
  background:var(--card-bg); color:var(--muted); font-weight:700; transition:all .2s ease;
  font-size:14px;
}
.cat-btn svg{filter:drop-shadow(0 4px 10px rgba(0,0,0,0.3))}
.cat-btn:hover{ border-color:var(--accent1); color:var(--text); }
.cat-btn.active{ background: linear-gradient(90deg,var(--accent1),var(--accent2)); color:#fff; box-shadow: var(--neon); border-color:var(--accent2); transform:translateY(-2px) }
.lang-filter{display:flex; gap:8px; align-items:center; margin-right:auto;}
.lang-btn{
  padding:8px 12px; border-radius:8px; background:var(--card-bg);
  border:1px solid var(--border-color); color:var(--muted); font-weight:600; cursor:pointer;
  transition:all .2s ease;
}
.lang-btn:hover{ border-color:var(--accent1); color:var(--text); }
.lang-btn.active{background:var(--accent1); color:#fff; border-color:var(--accent1); box-shadow:0 6px 20px rgba(43,130,255,0.15)}
.actions-right{margin-left:auto; display:flex; gap:8px; align-items:center}
.cards{
  display:grid; grid-template-columns:repeat(auto-fill,minmax(300px,1fr));
  gap:25px; margin-top:15px;
}
.card{
  background: var(--card-bg);
  border-radius:16px; padding:20px; border:1px solid var(--border-color);
  transition: transform .3s cubic-bezier(.2,.9,.25,1), box-shadow .3s ease;
  transform-style:preserve-3d;
  --tiltX:0deg; --tiltY:0deg;
  will-change:transform;
  position:relative; overflow:hidden;
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}
.card::after{
  content:""; position:absolute; inset:-1px; border-radius:17px; pointer-events:none;
  background:linear-gradient(90deg, transparent, rgba(123,60,255,0.1), transparent);
  opacity:0; transition:opacity .3s ease;
}
.card:hover{ transform: translateY(-5px) rotateX(var(--tiltX)) rotateY(var(--tiltY)); box-shadow: 0 20px 50px rgba(4,8,20,0.8); }
.card:hover::after{ opacity:1 }
.card-content{display:flex; justify-content:space-between; align-items:flex-start; gap:15px;}
.card .left{display:flex; gap:15px; align-items:flex-start}
.icon-wrap{width:50px;height:50px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.05); flex-shrink:0}
.card h3{margin:0 0 4px; font-size:18px; font-weight:800;}
.card .desc{color:var(--muted); font-size:14px; line-height:1.4;}
.badges{display:flex; gap:8px; margin-top:12px; flex-wrap:wrap}
.badge{padding:6px 10px; border-radius:999px; background:rgba(255,255,255,0.05); color:var(--muted); font-size:12px; border:1px solid rgba(255,255,255,0.05)}
.price{font-weight:900; color:var(--accent-cta); margin-top:15px; font-size:22px; text-align:left;}
.actions{display:flex; flex-direction:column; align-items:flex-end; gap:10px; min-width:120px; margin-top:10px;}
.btn{
  padding:10px 16px; border-radius:10px; cursor:pointer; font-weight:800; text-decoration:none; border: none;
  transition:all .2s ease;
}
.btn-wa{background:#25D366; color:#032; box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3);}
.btn-wa:hover{ background:#1EBE55; }
.btn-details{background:transparent; color:var(--muted); border:1px solid var(--border-color);}
.btn-details:hover{ background:rgba(255,255,255,0.05); color:var(--text); }

/* ========== MODAL STYLES (Fix for positioning) ========== */
.modal-bg{
  position:fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  z-index:2200;
  background:rgba(2,6,23,0.55);
  backdrop-filter:blur(8px);
  overflow-y: auto;
}
.modal-card{
  width:94%; max-width:520px;
  background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
  border-radius:16px;
  padding:20px;
  border:1px solid rgba(255,255,255,0.12);
  box-shadow:0 30px 80px rgba(0,0,0,0.6);
  position:relative;
  animation:slideUp .28s ease both;
  margin: 20px 0;
}
.modal-close{
  position:absolute; top:12px; left:12px;
  width:40px; height:40px; border-radius:50%;
  border:none; background:rgba(255,255,255,0.08); color:#fff; font-size:22px; cursor:pointer;
}
.neon{
  box-shadow: 0 0 12px rgba(0,213,255,0.14), 0 0 28px rgba(123,60,255,0.06);
  border:1px solid rgba(0,213,255,0.18);
}
.modal-card input, .modal-card select{
  width:100%; padding:12px; border-radius:10px; margin-top:6px; border:none;
  background:rgba(0,0,0,0.45); color:var(--text);
}
.price-box{
  padding:12px; border-radius:10px; background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.10); margin-top:8px; font-weight:700;
}
.confirm-box{position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:2600; background:rgba(0,0,0,0.65); backdrop-filter:blur(6px)}
.confirm-card{width:90%;max-width:420px;background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)); padding:18px;border-radius:14px;border:1px solid rgba(255,255,255,0.12); text-align:right}
.status-box{margin-top:12px;padding:10px;border-radius:10px;background:rgba(255,255,0,0.12);border:1px solid rgba(255,255,0,0.28);text-align:center}
.status-check-card{width:90%;max-width:480px;background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.08);text-align:right}
@keyframes slideUp {
  from { transform: translateY(50px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@media (max-width:768px){
  .cards{ grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); }
  .hero h1{ font-size:24px; }
  .hero p{ font-size:14px; }
  .top-offer{ display:none; }
  .lang-filter{ margin-right:0; margin-top:10px; }
  .controls{ flex-direction:column; align-items:flex-start; }
}
.small{font-size:12px;color:var(--muted)}
</style>
</head>
<body>
<div id="cursorFollow" class="cursor-follow" style="background:linear-gradient(90deg,var(--accent1),var(--accent2));width:18px;height:18px;position:fixed;left:0;top:0;border-radius:50%;pointer-events:none;z-index:2000;transform:translate(-50%,-50%);mix-blend-mode:screen;"></div>
<canvas id="particleCanvas" style="position:fixed;inset:0;z-index:1;pointer-events:none;"></canvas>
<canvas id="snowCanvas" style="position:fixed;inset:0;z-index:1;pointer-events:none;"></canvas>

<header class="header" id="siteHeader">
  <div class="logo">
    <div class="sym">M</div>
    <div>
      <div class="brand">MAZEN</div>
      <div class="tag small"></div>
    </div>
  </div>
  <div style="display:flex;align-items:center;gap:10px">
    <div class="small" style="font-weight:700;">ÙˆØ§ØªØ³Ø§Ø¨: <strong style="color:var(--accent-cta)">+963 980 962 294</strong></div>
    <div style="display:flex;gap:8px;align-items:center">
      <button id="checkStatusBtn" class="btn" title="ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ" style="background:transparent;border:1px solid var(--border-color);color:var(--muted);padding:8px 10px;border-radius:10px" onclick="openStatusChecker()">ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø·Ù„Ø¨</button>
      <button id="themeToggle" class="btn" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø«ÙŠÙ…" style="background:transparent;border:1px solid var(--border-color);color:var(--muted);padding:8px 10px;border-radius:10px">ğŸŒ™</button>
    </div>
  </div>
</header>

<main class="container">
  <section class="hero">
    
    </div>
    <div class="top-offer">
      <svg width="24" height="24" viewBox="0 0 24 24" style="filter:drop-shadow(0 6px 20px rgba(0,0,0,0.4))"><path d="M12 2l2.6 6.9L21 9.2l-5 3.7L17 20l-5-3.3L7 20l1-7.1-5-3.7 6.4-0.3L12 2z" fill="#ffd166"/></svg>
      <div style="line-height:1.2">
        <div style="font-size:16px;">Ø¹Ø±ÙˆØ¶ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø³Ù†Ø©</div>
        <small style="font-size:13px;">Ø®ØµÙˆÙ…Ø§Øª Ø¹Ù„Ù‰ Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø¨Ø¹ÙŠÙ† â€” Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</small>
      </div>
    </div>
  </section>

  <div class="controls">
    <div class="category-bar" id="categoryBar" role="tablist" aria-label="Ù…Ù†ØµØ§Øª Ø§Ù„ØªÙˆØ§ØµÙ„"></div>
    <div class="lang-filter">
      <button id="lg_all" class="lang-btn active" onclick="setLang('all')">Ø§Ù„ÙƒÙ„</button>
      <button id="lg_ar" class="lang-btn" onclick="setLang('arabic')">Ø¹Ø±Ø¨ÙŠ</button>
      <button id="lg_en" class="lang-btn" onclick="setLang('foreign')">Ø£Ø¬Ù†Ø¨ÙŠ</button>
    </div>
  </div>

  <div id="skeletonArea" class="cards" aria-hidden="false">
    <div class="card skel" style="height:150px;background:linear-gradient(90deg,#0f172a,#1e293b,#0f172a); animation: pulse 1.5s infinite;"></div>
    <div class="card skel" style="height:150px;background:linear-gradient(90deg,#0f172a,#1e293b,#0f172a); animation: pulse 1.5s infinite 0.2s;"></div>
    <div class="card skel" style="height:150px;background:linear-gradient(90deg,#0f172a,#1e293b,#0f172a); animation: pulse 1.5s infinite 0.4s;"></div>
    <div class="card skel" style="height:150px;background:linear-gradient(90deg,#0f172a,#1e293b,#0f172a); animation: pulse 1.5s infinite 0.6s;"></div>
  </div>
  <style>@keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }</style>

  <div id="servicesContainer" class="cards" style="display:none"></div>
</main>

<div id="orderModal" class="modal-bg" aria-hidden="true">
  <div class="modal-card neon">
    <button class="modal-close" onclick="closeOrder()">Ã—</button>
    <h2 id="modalTitle" style="margin-top:0;margin-bottom:15px;font-size:20px;">Ø·Ù„Ø¨ Ø®Ø¯Ù…Ø©:</h2>
    <div style="line-height:1.8;font-size:14px;color:var(--muted)">
      <div id="modalDesc"></div>
      <div id="modalMinMax" style="margin-top:8px;"></div>
    </div>
    <div style="margin-top:20px">
      <label for="orderLinkAuto" style="font-weight:700;font-size:14px;">Ø±Ø§Ø¨Ø· Ø§Ù„Ø­Ø³Ø§Ø¨/Ø§Ù„Ù…Ù†Ø´ÙˆØ±:</label>
      <input type="text" id="orderLinkAuto" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· Ù‡Ù†Ø§" required>
    </div>
    <div style="margin-top:15px">
      <label for="orderQty" style="font-weight:700;font-size:14px;">Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</label>
      <input type="number" id="orderQty" placeholder="Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ 100" required>
    </div>
    <div style="margin-top:15px">
      <label for="paymentMethodAuto" style="font-weight:700;font-size:14px;">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</label>
      <select id="paymentMethodAuto">
        <option value="syr">Ø³ÙŠØ±ÙŠØªÙ„ ÙƒØ§Ø´</option>
        <option value="sham">Ø´Ø§Ù… ÙƒØ§Ø´ (ÙƒÙˆØ¯)</option>
      </select>
    </div>

    <div class="price-box">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <span style="font-size:14px;color:var(--muted)">Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠØ©:</span>
        <span id="totalPrice" style="font-size:24px;color:var(--accent-cta);font-weight:900;">0 Ù„.Ø³</span>
      </div>
    </div>
    <button onclick="confirmAndSend()" style="margin-top:20px;padding:12px 20px;border:none;border-radius:10px;background:var(--accent2);color:#fff;font-size:16px;cursor:pointer;width:100%;font-weight:800;box-shadow:0 6px 20px rgba(122,60,255,0.3);">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</button>
  </div>
</div>

<div id="confirmBox" class="confirm-box" aria-hidden="true">
  <div id="confirmCard" class="confirm-card"></div>
</div>

<div id="statusChecker" class="modal-bg" aria-hidden="true">
  <div class="modal-card">
    <button class="modal-close" onclick="closeStatusChecker()">Ã—</button>
    <h2 style="margin-top:0;margin-bottom:15px;font-size:20px;">ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨</h2>
    <div style="margin-top:20px">
      <label for="statusOrderId" style="font-weight:700;font-size:14px;">Ù…Ø¹Ø±Ù Ø§Ù„Ø·Ù„Ø¨:</label>
      <input type="number" id="statusOrderId" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ø·Ù„Ø¨ Ù‡Ù†Ø§" required>
    </div>
    <button onclick="checkOrderStatus()" style="margin-top:15px;padding:12px 20px;border:none;border-radius:10px;background:var(--accent1);color:#fff;font-size:16px;cursor:pointer;width:100%;font-weight:800;">ØªØ­Ù‚Ù‚</button>
    <div id="statusResult" class="status-box" style="display:none; margin-top:15px; background:rgba(43,130,255,0.1); border-color:rgba(43,130,255,0.3);"></div>
  </div>
</div>

<audio id="successSound" src="https://www.soundjay.com/button/button-3.mp3" preload="auto"></audio>

<script>
// ==================================================================================
// ==================== Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ù‡Ù„ Ù„Ù„Ø£Ù‚Ø³Ø§Ù… ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª ====================
// ==================================================================================

const WA_NUMBER = '963980962294';
const SYRITEL_NUMBER = '0980962294';
const SHAM_CODE = 'bc6cc5f8ce57b34373d251b964853432';
const USD_TO_SYP_RATE = 15000;

const CATEGORIES = [
  { id: 'instagram', title: 'Ø§Ù†Ø³ØªØ¬Ø±Ø§Ù…', icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg>' },
  { id: 'tiktok', title: 'ØªÙŠÙƒ ØªÙˆÙƒ', icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.04 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>' },
  { id: 'telegram', title: 'ØªÙ„ÙŠØ¬Ø±Ø§Ù…', icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 11-9 11s-9-4-9-11a9 9 0 0 1 18 0z"></path><polyline points="12 2 12 12"></polyline></svg>' },
  { id: 'youtube', title: 'ÙŠÙˆØªÙŠÙˆØ¨', icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.42a2.78 2.78 0 0 0-1.94 2C2 8.16 2 12 2 12s0 3.84.46 5.58a2.78 2.78 0 0 0 1.94 2C5.12 20 12 20 12 20s6.88 0 8.6-.42a2.78 2.78 0 0 0 1.94-2C22 15.84 22 12 22 12s0-3.84-.46-5.58z"></path><polygon points="10 15 15 12 10 9 10 15"></polygon></svg>' },
  { id: 'facebook', title: 'ÙÙŠØ³Ø¨ÙˆÙƒ', icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>' },
  { id: 'twitter', title: 'ØªÙˆÙŠØªØ±', icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>' },
 
];

const SERVICES = [
  { id: 1, cat: 'instagram', title: 'Ù…ØªØ§Ø¨Ø¹ÙŠÙ† Ø§Ù†Ø³ØªØ¬Ø±Ø§Ù… (Ø¹Ø±Ø¨ÙŠ)', desc: 'Ù…ØªØ§Ø¨Ø¹ÙŠÙ† Ø¹Ø±Ø¨ Ø­Ù‚ÙŠÙ‚ÙŠÙŠÙ† ÙˆÙ…Ø¶Ù…ÙˆÙ†ÙŠÙ†ØŒ Ø³Ø±Ø¹Ø© Ø¹Ø§Ù„ÙŠØ©.', price: 1.2, lang: 'ar', min: 100, max: 100000, speed: 'Ø³Ø±ÙŠØ¹', quality: 'Ø¹Ø§Ù„ÙŠ' },
  { id: 2, cat: 'instagram', title: 'Ù…ØªØ§Ø¨Ø¹ÙŠÙ† Ø§Ù†Ø³ØªØ¬Ø±Ø§Ù… (Ø£Ø¬Ù†Ø¨ÙŠ)', desc: 'Ù…ØªØ§Ø¨Ø¹ÙŠÙ† Ø£Ø¬Ø§Ù†Ø¨ Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©ØŒ Ø¨Ø¯Ø¡ ÙÙˆØ±ÙŠ.', price: 0.8, lang: 'en', min: 100, max: 100000, speed: 'Ù…ØªÙˆØ³Ø·', quality: 'Ø¹Ø§Ø¯ÙŠ' },
  { id: 3, cat: 'instagram', title: 'Ù„Ø§ÙŠÙƒØ§Øª Ø§Ù†Ø³ØªØ¬Ø±Ø§Ù… (Ø¹Ø±Ø¨ÙŠ)', desc: 'Ù„Ø§ÙŠÙƒØ§Øª Ø¹Ø±Ø¨ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§ØªØŒ Ø«Ø§Ø¨ØªØ©.', price: 0.5, lang: 'ar', min: 50, max: 50000, speed: 'Ø³Ø±ÙŠØ¹', quality: 'Ø¹Ø§Ù„ÙŠ' },
  { id: 4, cat: 'instagram', title: 'Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ø±ÙŠÙ„Ø² Ø§Ù†Ø³ØªØ¬Ø±Ø§Ù…', desc: 'Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ø³Ø±ÙŠØ¹Ø© Ø¬Ø¯Ø§Ù‹ Ù„Ù„Ø±ÙŠÙ„Ø²ØŒ Ø¬ÙˆØ¯Ø© Ù…Ù…ØªØ§Ø²Ø©.', price: 0.1, lang: 'en', min: 1000, max: 500000, speed: 'ÙÙˆØ±ÙŠ', quality: 'Ø¹Ø§Ù„ÙŠ' },
  { id: 5, cat: 'tiktok', title: 'Ù…ØªØ§Ø¨Ø¹ÙŠÙ† ØªÙŠÙƒ ØªÙˆÙƒ (Ø¹Ø±Ø¨ÙŠ)', desc: 'Ù…ØªØ§Ø¨Ø¹ÙŠÙ† Ø¹Ø±Ø¨ Ø­Ù‚ÙŠÙ‚ÙŠÙŠÙ†ØŒ Ø¶Ù…Ø§Ù† ØªØ¹ÙˆÙŠØ¶.', price: 1.5, lang: 'ar', min: 100, max: 50000, speed: 'Ù…ØªÙˆØ³Ø·', quality: 'Ø¹Ø§Ù„ÙŠ' },
  { id: 6, cat: 'tiktok', title: 'Ù…ØªØ§Ø¨Ø¹ÙŠÙ† ØªÙŠÙƒ ØªÙˆÙƒ (Ø£Ø¬Ù†Ø¨ÙŠ)', desc: 'Ù…ØªØ§Ø¨Ø¹ÙŠÙ† Ø£Ø¬Ø§Ù†Ø¨ØŒ Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© Ø¬Ø¯Ø§Ù‹.', price: 1.0, lang: 'en', min: 100, max: 100000, speed: 'Ø³Ø±ÙŠØ¹', quality: 'Ø¹Ø§Ù„ÙŠ' },
  { id: 7, cat: 'tiktok', title: 'Ù„Ø§ÙŠÙƒØ§Øª ØªÙŠÙƒ ØªÙˆÙƒ', desc: 'Ù„Ø§ÙŠÙƒØ§Øª Ø¹Ù„Ù‰ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§ØªØŒ Ø¨Ø¯Ø¡ ÙÙˆØ±ÙŠ.', price: 0.6, lang: 'en', min: 50, max: 50000, speed: 'ÙÙˆØ±ÙŠ', quality: 'Ø¹Ø§Ø¯ÙŠ' },
  { id: 8, cat: 'telegram', title: 'Ø£Ø¹Ø¶Ø§Ø¡ Ù‚Ù†Ø§Ø© ØªÙ„ÙŠØ¬Ø±Ø§Ù… (Ø¹Ø±Ø¨ÙŠ)', desc: 'Ø£Ø¹Ø¶Ø§Ø¡ Ø¹Ø±Ø¨ Ø­Ù‚ÙŠÙ‚ÙŠÙŠÙ† Ù„Ù‚Ù†Ø§ØªÙƒØŒ Ø«Ø§Ø¨ØªÙŠÙ†.', price: 2.0, lang: 'ar', min: 50, max: 10000, speed: 'Ù…ØªÙˆØ³Ø·', quality: 'Ø¹Ø§Ù„ÙŠ' },
  { id: 9, cat: 'telegram', title: 'Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ù…Ù†Ø´ÙˆØ±Ø§Øª ØªÙ„ÙŠØ¬Ø±Ø§Ù…', desc: 'Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ø³Ø±ÙŠØ¹Ø© Ø¬Ø¯Ø§Ù‹ Ù„Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª.', price: 0.2, lang: 'en', min: 1000, max: 200000, speed: 'ÙÙˆØ±ÙŠ', quality: 'Ø¹Ø§Ø¯ÙŠ' },
  { id: 10, cat: 'youtube', title: 'Ù…Ø´ØªØ±ÙƒÙŠÙ† ÙŠÙˆØªÙŠÙˆØ¨', desc: 'Ù…Ø´ØªØ±ÙƒÙŠÙ† Ø­Ù‚ÙŠÙ‚ÙŠÙŠÙ†ØŒ Ø¶Ù…Ø§Ù† 30 ÙŠÙˆÙ….', price: 5.0, lang: 'en', min: 10, max: 1000, speed: 'Ø¨Ø·ÙŠØ¡', quality: 'Ø¹Ø§Ù„ÙŠ' },
  { id: 11, cat: 'youtube', title: 'Ù…Ø´Ø§Ù‡Ø¯Ø§Øª ÙŠÙˆØªÙŠÙˆØ¨', desc: 'Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©ØŒ Ø«Ø§Ø¨ØªØ©.', price: 0.9, lang: 'en', min: 1000, max: 500000, speed: 'Ø³Ø±ÙŠØ¹', quality: 'Ø¹Ø§Ù„ÙŠ' },
  { id: 12, cat: 'facebook', title: 'Ù…ØªØ§Ø¨Ø¹ÙŠÙ† ØµÙØ­Ø© ÙÙŠØ³Ø¨ÙˆÙƒ (Ø¹Ø±Ø¨ÙŠ)', desc: 'Ù…ØªØ§Ø¨Ø¹ÙŠÙ† Ø¹Ø±Ø¨ Ø­Ù‚ÙŠÙ‚ÙŠÙŠÙ† Ù„Ù„ØµÙØ­Ø©.', price: 1.8, lang: 'ar', min: 100, max: 20000, speed: 'Ù…ØªÙˆØ³Ø·', quality: 'Ø¹Ø§Ù„ÙŠ' },
  { id: 13, cat: 'facebook', title: 'Ù„Ø§ÙŠÙƒØ§Øª Ù…Ù†Ø´ÙˆØ± ÙÙŠØ³Ø¨ÙˆÙƒ', desc: 'Ù„Ø§ÙŠÙƒØ§Øª Ø¹Ø±Ø¨ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª.', price: 0.7, lang: 'ar', min: 50, max: 10000, speed: 'Ø³Ø±ÙŠØ¹', quality: 'Ø¹Ø§Ø¯ÙŠ' },
  { id: 14, cat: 'twitter', title: 'Ù…ØªØ§Ø¨Ø¹ÙŠÙ† ØªÙˆÙŠØªØ± (Ø£Ø¬Ù†Ø¨ÙŠ)', desc: 'Ù…ØªØ§Ø¨Ø¹ÙŠÙ† Ø£Ø¬Ø§Ù†Ø¨ØŒ Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©.', price: 1.1, lang: 'en', min: 100, max: 50000, speed: 'Ù…ØªÙˆØ³Ø·', quality: 'Ø¹Ø§Ù„ÙŠ' },
];

let currentCategory = CATEGORIES[0].id;
let currentLang = 'all';
let currentServiceId = null;
let currentPriceUSD = 0;
let orderCounter = Number(localStorage.getItem('mazen_order_counter') || 1000);

function esc(str){ if(!str) return ''; return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/'/g, '&#039;'); }
function pricePer1000SYP(priceUSD){ return Math.ceil(priceUSD * USD_TO_SYP_RATE); }

function buildCategories(){
  const bar = document.getElementById('categoryBar');
  bar.innerHTML = CATEGORIES.map(c => {
    const isActive = c.id === currentCategory ? 'active' : '';
    return `<button class="cat-btn ${isActive}" onclick="setCategory('${c.id}')" role="tab" aria-selected="${isActive ? 'true' : 'false'}">
      ${c.icon}
      <span>${c.title}</span>
    </button>`;
  }).join('');
}

function setCategory(cat){
  currentCategory = cat;
  document.querySelectorAll('.cat-btn').forEach(b=>b.classList.remove('active'));
  document.querySelector(`.cat-btn[onclick="setCategory('${cat}')"]`).classList.add('active');
  renderServices();
}

function setLang(lang){
  currentLang = lang;
  document.querySelectorAll('.lang-btn').forEach(b=>b.classList.remove('active'));
  let idSuffix = '';
  if(lang === 'all') idSuffix = 'all';
  else if(lang === 'arabic') idSuffix = 'ar';
  else if(lang === 'foreign') idSuffix = 'en';
  const activeBtn = document.getElementById('lg_'+idSuffix);
  if(activeBtn) activeBtn.classList.add('active');
  renderServices();
}

function renderServices(){
  const container = document.getElementById('servicesContainer');
  const filteredByCategory = SERVICES.filter(s => s.cat === currentCategory);
  const filteredByLang = filteredByCategory.filter(s => {
    const serviceLang = s.lang ? s.lang.toLowerCase() : 'unknown';
    if(currentLang === 'all') return true;
    if(currentLang === 'arabic' && serviceLang === 'ar') return true;
    if(currentLang === 'foreign' && serviceLang === 'en') return true;
    return false;
  });
  
  if(filteredByLang.length === 0){
    container.innerHTML = `<div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: var(--muted); font-size: 18px; background: var(--card-bg); border-radius: 12px; border: 1px solid var(--border-color);">
      Ù„Ø§ ØªÙˆØ¬Ø¯ Ø®Ø¯Ù…Ø§Øª Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©.
    </div>`;
    return;
  }
  
  container.innerHTML = filteredByLang.map(s => {
    const icon = CATEGORIES.find(c => c.id === s.cat)?.icon || '';
    const priceSYP = pricePer1000SYP(s.price);
    
    return `
      <div class="card" onclick="openOrder(${s.id})">
        <div class="card-content">
          <div class="left">
            <div class="icon-wrap">${icon}</div>
            <div>
              <h3>${esc(s.title)}</h3>
              <p class="desc">${esc(s.desc)}</p>
              <div class="badges">
                <span class="badge">Ø§Ù„Ø³Ø±Ø¹Ø©: ${esc(s.speed)}</span>
                <span class="badge">Ø§Ù„Ø¬ÙˆØ¯Ø©: ${esc(s.quality)}</span>
                <span class="badge">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰: ${s.min.toLocaleString()}</span>
              </div>
            </div>
          </div>
          <div class="actions">
            <div class="price">${priceSYP.toLocaleString()} Ù„.Ø³ / 1000</div>
            <button class="btn btn-wa" onclick="event.stopPropagation(); openOrder(${s.id})">Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</button>
            <button class="btn btn-details" onclick="event.stopPropagation(); openOrder(${s.id})">Ø§Ù„ØªÙØ§ØµÙŠÙ„</button>
          </div>
        </div>
      </div>
    `;
  }).join('');
  
  if(EFFECTS.tilt){
    document.querySelectorAll('.card').forEach(card => {
      card.addEventListener('mousemove', handleTilt);
      card.addEventListener('mouseleave', resetTilt);
    });
  }
}

function handleTilt(e){
  const card = e.currentTarget;
  const rect = card.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;
  const centerX = rect.width / 2;
  const centerY = rect.height / 2;
  const tiltX = (centerY - y) / 15;
  const tiltY = (x - centerX) / 15;
  card.style.setProperty('--tiltX', `${tiltX}deg`);
  card.style.setProperty('--tiltY', `${tiltY}deg`);
}

function resetTilt(e){
  const card = e.currentTarget;
  card.style.setProperty('--tiltX', '0deg');
  card.style.setProperty('--tiltY', '0deg');
}

function openOrder(serviceId){
  const service = SERVICES.find(s => s.id === serviceId);
  if(!service) return;
  
  currentServiceId = serviceId;
  currentPriceUSD = service.price;
  
  document.getElementById('modalTitle').innerText = `Ø·Ù„Ø¨ Ø®Ø¯Ù…Ø©: ${service.title}`;
  document.getElementById('modalDesc').innerHTML = `<strong>Ø§Ù„ÙˆØµÙ:</strong> ${service.desc}`;
  document.getElementById('modalMinMax').innerHTML = `<strong>Ø§Ù„Ø­Ø¯ÙˆØ¯:</strong> Ù…Ù† ${service.min.toLocaleString()} Ø¥Ù„Ù‰ ${service.max.toLocaleString()} - <strong>Ø§Ù„Ø³Ø¹Ø±:</strong> ${pricePer1000SYP(service.price).toLocaleString()} Ù„.Ø³ / 1000`;
  
  const lastOrder = JSON.parse(localStorage.getItem('mazen_last_order') || '{}');
  document.getElementById('orderQty').value = lastOrder.qty || service.min;
  document.getElementById('orderLinkAuto').value = lastOrder.link || '';

  document.getElementById('paymentMethodAuto').value = lastOrder.method || 'syr';
  
  updatePrice();
  
  document.getElementById('orderModal').style.display = 'flex';
  document.getElementById('orderModal').setAttribute('aria-hidden','false');
}

function closeOrder(){
  document.getElementById('orderModal').style.display = 'none';
  document.getElementById('orderModal').setAttribute('aria-hidden','true');
}

function updatePrice(){
  const qty = Number(document.getElementById('orderQty').value || 0);
  const basePer1000 = pricePer1000SYP(currentPriceUSD);
  const total = Math.ceil((qty/1000) * basePer1000);
  document.getElementById('totalPrice').innerText = `${total.toLocaleString()} Ù„.Ø³`;
}

document.getElementById('orderQty').addEventListener('input', updatePrice);

function validateInputs(checkTransferCode = true){
  const service = SERVICES.find(s => s.id === currentServiceId);
  if(!service) return false;
  
  const link = document.getElementById('orderLinkAuto').value.trim();
  const qty = Number(document.getElementById('orderQty').value || 0);
  const code = ''; // ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø­Ù‚Ù„ Ù…Ù† Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
  
  if(!link){ alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„Ø­Ø³Ø§Ø¨ Ø£Ùˆ Ø§Ù„Ù…Ù†Ø´ÙˆØ±'); return false; }
  if(!qty || qty < service.min){ alert(`Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„ÙƒÙ…ÙŠØ© Ù‡Ùˆ ${service.min.toLocaleString()}`); return false; }
  if(qty > service.max){ alert(`Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„ÙƒÙ…ÙŠØ© Ù‡Ùˆ ${service.max.toLocaleString()}`); return false; }
  
  return true;
}

function saveOrderObject(order){
  const raw = localStorage.getItem('mazen_orders');
  const arr = raw ? JSON.parse(raw) : [];
  arr.push(order);
  localStorage.setItem('mazen_orders', JSON.stringify(arr));
  localStorage.setItem('mazen_order_counter', String(order.orderId));
}

function copyToClipboard(text, elId) {
  // Fallback for non-secure contexts or older browsers
  if (!navigator.clipboard) {
    const textarea = document.createElement('textarea');
    textarea.value = text;
    document.body.appendChild(textarea);
    textarea.select();
    try {
      document.execCommand('copy');
      const el = document.getElementById(elId);
      const originalText = el.innerText;
      el.innerText = 'ØªÙ… Ø§Ù„Ù†Ø³Ø®!';
      setTimeout(() => { el.innerText = originalText; }, 1500);
    } catch (err) {
      console.error('Could not copy text: ', err);
      alert('ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø®ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù†Ø³Ø® ÙŠØ¯ÙˆÙŠØ§Ù‹: ' + text);
    }
    document.body.removeChild(textarea);
    return;
  }
  
  // Modern approach
  navigator.clipboard.writeText(text).then(() => {
    const el = document.getElementById(elId);
    const originalText = el.innerText;
    el.innerText = 'ØªÙ… Ø§Ù„Ù†Ø³Ø®!';
    setTimeout(() => { el.innerText = originalText; }, 1500);
  }).catch(err => {
    console.error('Could not copy text: ', err);
    alert('ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø®ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù†Ø³Ø® ÙŠØ¯ÙˆÙŠØ§Ù‹: ' + text);
  });
}

function confirmAndSend(){
  if(!validateInputs(false)) return;
  
  const link = document.getElementById('orderLinkAuto').value.trim();
  const qty = Number(document.getElementById('orderQty').value || 0);
  const code = ''; // ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø­Ù‚Ù„ Ù…Ù† Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
  const pay = document.getElementById('paymentMethodAuto').value;
  
  const basePer1000 = pricePer1000SYP(currentPriceUSD);
  const total = Math.ceil((qty/1000) * basePer1000);
  
  const id = ++orderCounter;
  
  const service = SERVICES.find(x=>x.id === currentServiceId) || {title: 'â€”'};
  const orderObj = {
    orderId: id,
    serviceId: currentServiceId,
    serviceTitle: service.title,
    qty: qty,
    total_lira: total,
    link: link,
    transfer_code: code,
    payment_method: pay,
    status: 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',
    created_at: new Date().toISOString()
  };
  
  localStorage.setItem('mazen_last_order', JSON.stringify({qty, link, method: pay}));
  saveOrderObject(orderObj);
  
  try{ document.getElementById('successSound').currentTime = 0; document.getElementById('successSound').play(); }catch(e){}
  
  const paymentMethod = orderObj.payment_method;
  let paymentValue = '';
  let paymentLabel = '';
  let paymentName = '';
  
  if (paymentMethod === 'syr') {
    paymentValue = SYRITEL_NUMBER;
    paymentLabel = 'Ø±Ù‚Ù… Ø³ÙŠØ±ÙŠØªÙ„ ÙƒØ§Ø´';
    paymentName = 'Ø³ÙŠØ±ÙŠØªÙ„ ÙƒØ§Ø´';
  } else if (paymentMethod === 'sham') {
    paymentValue = SHAM_CODE;
    paymentLabel = 'ÙƒÙˆØ¯ Ø´Ø§Ù… ÙƒØ§Ø´';
    paymentName = 'Ø´Ø§Ù… ÙƒØ§Ø´';
  }

  const paymentDetailsHTML = `
    <div style="margin-top:18px; padding-top:15px; border-top:1px solid var(--border-color);">
      <h3 style="margin:0 0 10px; font-size:16px; color:var(--accent-cta);">Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¯ÙØ¹:</h3>
      <p style="margin:0 0 10px; font-size:14px; color:var(--muted);">ÙŠØ±Ø¬Ù‰ ØªØ­ÙˆÙŠÙ„ Ù…Ø¨Ù„Øº <strong>${orderObj.total_lira.toLocaleString()} Ù„.Ø³</strong> Ø¥Ù„Ù‰ ${paymentName} Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ§Ù„ÙŠØ©:</p>
      <div style="display:flex; align-items:center; justify-content:space-between; background:var(--card-bg); padding:10px; border-radius:8px; border:1px solid var(--border-color);">
        <span style="font-weight:700; font-size:16px; color:var(--text);" id="paymentValue">${paymentValue}</span>
        <button id="copyBtn" onclick="copyToClipboard('${paymentValue}', 'copyBtn')" style="padding:8px 12px; border-radius:6px; border:none; background:var(--accent1); color:#fff; font-weight:700; cursor:pointer; transition:background .2s ease;">Ù†Ø³Ø®</button>
      </div>
      <p style="margin:10px 0 0 0; font-size:13px; color:var(--muted);">ÙŠØ±Ø¬Ù‰ Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹. Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ØŒ Ø³ØªØ­ØµÙ„ Ø¹Ù„Ù‰ ÙƒÙˆØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø°ÙŠ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„Ù‡ ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¥Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨.</p>
    </div>
  `;

  const confirmHTML = `
    <h2 style="margin-top:0;margin-bottom:12px;color:var(--success)">âœ” ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ</h2>
    <div class="status-box" style="background:rgba(34,197,94,0.12); border-color:rgba(34,197,94,0.28);">Ø§Ù„Ø­Ø§Ù„Ø©: <strong>${orderObj.status}</strong></div>
    <div style="text-align:right;line-height:2;margin-top:18px;font-size:15px;border-top:1px solid var(--border-color); padding-top:15px;">
      <b>Ø§Ù„Ù…Ø¹Ø±Ù:</b> <span style="color:var(--accent-cta); font-size:18px;">${orderObj.orderId}</span><br>
      <b>Ø§Ù„Ø®Ø¯Ù…Ø©:</b> ${esc(orderObj.serviceTitle)}<br>
      <b>Ø§Ù„Ø±Ø§Ø¨Ø·:</b> ${esc(orderObj.link)}<br>
      <b>Ø§Ù„ÙƒÙ…ÙŠØ©:</b> ${orderObj.qty.toLocaleString()}<br>
      <b>Ø§Ù„ØªÙƒÙ„ÙØ©:</b> ${orderObj.total_lira.toLocaleString()} Ù„.Ø³
    </div>
    ${paymentDetailsHTML}
<div style="margin-top:18px;font-size:13px;color:var(--muted); border-bottom:1px solid var(--border-color); padding-bottom:15px;">
	      Ø§Ø­ØªÙØ¸ Ø¨Ø§Ù„Ù…Ø¹Ø±Ù Ù„ØªØªØ¨Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ Ù„Ø§Ø­Ù‚Ù‹Ø§.
	    </div>
	    <div id="transferCodeArea" style="margin-top:20px; padding:15px; border-radius:10px; background:rgba(255,209,102,0.1); border:1px solid rgba(255,209,102,0.2);">
	      <p style="font-weight:700; margin-top:0; color:var(--text);">Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø£Ø®ÙŠØ±Ø©: ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹</p>
	      <p style="font-size:13px; color:var(--muted); margin:4px 0 10px;">Ø¨Ø¹Ø¯ Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„ØŒ Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø°ÙŠ ÙˆØµÙ„Ùƒ Ø¨Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø«Ù… Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ù„Ù„Ø¥Ø±Ø³Ø§Ù„.</p>
	      <input type="text" id="finalTransferCode" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ù‡Ù†Ø§" style="width:100%; padding:10px; border-radius:8px; margin-top:8px; border:1px solid var(--border-color); background:var(--card-bg); color:var(--text);">
	      <button onclick="sendWA(${orderObj.orderId})"
	        style="margin-top:15px;padding:12px 20px;border:none;border-radius:10px;background:#25D366;color:#032;font-size:16px;cursor:pointer;width:100%;font-weight:800;">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨</button>
	    </div>
  `;
  document.getElementById('confirmCard').innerHTML = confirmHTML;
  document.getElementById('confirmBox').style.display = 'flex';
  document.getElementById('confirmBox').setAttribute('aria-hidden','false');
  
  document.getElementById('orderModal').style.display = 'none';
  document.getElementById('orderModal').setAttribute('aria-hidden','true');
}

function sendWA(orderId){
  const finalCode = document.getElementById('finalTransferCode').value.trim();
  if(!finalCode){
    alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø°ÙŠ ÙˆØµÙ„Ùƒ Ø¨Ø¹Ø¯ Ø§Ù„Ø¯ÙØ¹ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©.');
    return;
  }
  
  const arr = JSON.parse(localStorage.getItem('mazen_orders') || '[]');
  let o = arr.find(x=>x.orderId === orderId);
  
  if(!o){
    alert('Ø®Ø·Ø£: Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨ Ù„Ø¥Ø±Ø³Ø§Ù„Ù‡.');
    return;
  }
  
  // ØªØ­Ø¯ÙŠØ« ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ ÙÙŠ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ù…Ø®Ø²Ù† Ù…Ø­Ù„ÙŠØ§Ù‹
  o.transfer_code = finalCode;
  localStorage.setItem('mazen_orders', JSON.stringify(arr));
  
  const paymentInfo = o.payment_method === 'syr' ? `Ø³ÙŠØ±ÙŠØªÙ„ ÙƒØ§Ø´: ${SYRITEL_NUMBER}` : `Ø´Ø§Ù… ÙƒØ§Ø´ (ÙƒÙˆØ¯): ${SHAM_CODE}`;
  const msg = `ğŸ“ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯\n\n`+
              `ğŸ†” Ø§Ù„Ù…Ø¹Ø±Ù: ${o.orderId}\n`+
              `ğŸ”§ Ø§Ù„Ø®Ø¯Ù…Ø©: ${o.serviceTitle}\n`+
              `ğŸ”¢ Ø§Ù„ÙƒÙ…ÙŠØ©: ${o.qty.toLocaleString()}\n`+
              `ğŸ’° Ø§Ù„ØªÙƒÙ„ÙØ©: ${o.total_lira.toLocaleString()} Ù„.Ø³\n`+
              `ğŸ“ Ø§Ù„Ø±Ø§Ø¨Ø·: ${o.link}\n`+
              `ğŸ”‘ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„: ${finalCode}\n`+ // Ø§Ø³ØªØ®Ø¯Ø§Ù… finalCode Ø§Ù„Ø¬Ø¯ÙŠØ¯
              `ğŸ’³ Ø§Ù„Ø¯ÙØ¹: ${paymentInfo}\n\n(ØªÙ… ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§Ø¬Ù‡Ø© MAZEN â€” Ø§Ù„Ø­Ø§Ù„Ø©: ${o.status})`;
  window.open(`https://wa.me/${WA_NUMBER}?text=${encodeURIComponent(msg)}`, '_blank', 'noopener');
  document.getElementById('confirmBox').style.display = 'none';
}

function openStatusChecker(){
  document.getElementById('statusChecker').style.display = 'flex';
  document.getElementById('statusChecker').setAttribute('aria-hidden','false');
  document.getElementById('statusOrderId').value = '';
  document.getElementById('statusResult').style.display = 'none';
}

function closeStatusChecker(){
  document.getElementById('statusChecker').style.display = 'none';
  document.getElementById('statusChecker').setAttribute('aria-hidden','true');
}

function checkOrderStatus(){
  const idStr = document.getElementById('statusOrderId').value.trim();
  if(!idStr){ alert('Ø£Ø¯Ø®Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ø·Ù„Ø¨'); return; }
  const id = Number(idStr);
  const arr = JSON.parse(localStorage.getItem('mazen_orders') || '[]');
  const o = arr.find(x=>x.orderId === id);
  const resultEl = document.getElementById('statusResult');
  
  resultEl.style.display = 'block';
  
  if(!o){
    resultEl.style.background = 'rgba(255,0,0,0.12)';
    resultEl.style.borderColor = 'rgba(255,0,0,0.28)';
    resultEl.innerHTML = `<div style="color:var(--muted)">Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø¨Ø§Ù„Ù…Ø¹Ø±Ù: <strong>${esc(idStr)}</strong></div>`;
    return;
  }
  
  resultEl.style.background = 'rgba(43,130,255,0.1)';
  resultEl.style.borderColor = 'rgba(43,130,255,0.3)';
  resultEl.innerHTML = `
    <div style="text-align:right;line-height:1.8">
      <div><b>Ø§Ù„Ù…Ø¹Ø±Ù:</b> ${o.orderId}</div>
      <div><b>Ø§Ù„Ø®Ø¯Ù…Ø©:</b> ${esc(o.serviceTitle)}</div>
      <div><b>Ø§Ù„ÙƒÙ…ÙŠØ©:</b> ${o.qty.toLocaleString()}</div>
      <div><b>Ø§Ù„ØªÙƒÙ„ÙØ©:</b> ${o.total_lira.toLocaleString()} Ù„.Ø³</div>
      <div><b>Ø§Ù„Ø­Ø§Ù„Ø©:</b> <strong style="color:var(--accent-cta);">${o.status}</strong></div>
      <div><b>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨:</b> ${new Date(o.created_at).toLocaleString()}</div>
    </div>
    <div style="margin-top:12px">
      <button onclick="sendWA(${o.orderId})" class="btn btn-wa" style="padding:9px 12px;border-radius:10px;width:100%;">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø¥Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨</button>
    </div>
  `;
}

document.addEventListener('click', (e)=>{
  const confirmBox = document.getElementById('confirmBox');
  if(confirmBox.style.display === 'flex' && e.target === confirmBox) confirmBox.style.display = 'none';
  const statusBox = document.getElementById('statusChecker');
  if(statusBox.style.display === 'flex' && e.target === statusBox) closeStatusChecker();
  const orderBox = document.getElementById('orderModal');
  if(orderBox.style.display === 'flex' && e.target === orderBox) closeOrder();
});
document.addEventListener('keydown', e=>{
  if(e.key === 'Escape'){
    if(document.getElementById('confirmBox').style.display === 'flex') document.getElementById('confirmBox').style.display = 'none';
    else if(document.getElementById('statusChecker').style.display === 'flex') closeStatusChecker();
    else closeOrder();
  }
});

const EFFECTS = { snow:false, particles:true, cursorGlow:true, tilt:true, neonLines:true };

const cursorEl = document.getElementById('cursorFollow');
if(EFFECTS.cursorGlow){
  document.addEventListener('mousemove', (e)=>{
    cursorEl.style.left = e.clientX + 'px';
    cursorEl.style.top = e.clientY + 'px';
    cursorEl.style.width = '24px'; cursorEl.style.height = '24px';
  });
  document.addEventListener('mousedown', ()=>{ cursorEl.style.transform = 'translate(-50%,-50%) scale(.8)'; });
  document.addEventListener('mouseup', ()=>{ cursorEl.style.transform = 'translate(-50%,-50%) scale(1)'; });
} else cursorEl.style.display = 'none';

(function ParticleSystem(){
  if(!EFFECTS.particles) return;
  const canvas = document.getElementById('particleCanvas');
  const ctx = canvas.getContext('2d');
  let w = canvas.width = window.innerWidth;
  let h = canvas.height = window.innerHeight;
  const particles = [];
  const COUNT = Math.max(30, Math.floor(w/60));
  for(let i=0;i<COUNT;i++){
    particles.push({
      x: Math.random()*w, y: Math.random()*h, r: 0.6 + Math.random()*1.6,
      vx: (Math.random()*0.6)-0.3, vy: (Math.random()*0.2)+0.05, a: 0.05 + Math.random()*0.2
    });
  }
  window.addEventListener('resize', ()=>{ w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; });
  let t=0;
  function loop(){
    ctx.clearRect(0,0,w,h);
    for(const p of particles){
      p.x += p.vx + Math.sin((t+p.x)/200)*0.2;
      p.y += p.vy;
      if(p.y > h + 5){ p.y = -10; p.x = Math.random()*w; }
      ctx.beginPath();
      ctx.fillStyle = `rgba(255,255,255,${p.a})`;
      ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
      ctx.fill();
    }
    t++;
    requestAnimationFrame(loop);
  }
  loop();
})();

(function SnowSparkles(){
  if(!EFFECTS.snow) return;
  const canvas = document.getElementById('snowCanvas');
  const ctx = canvas.getContext('2d');
  let w = canvas.width = window.innerWidth;
  let h = canvas.height = window.innerHeight;
  const flakes = [];
  const COUNT = Math.max(40, Math.floor(w/40));
  for(let i=0;i<COUNT;i++){
    flakes.push({ x: Math.random()*w, y: Math.random()*h, r: Math.random()*1.6+0.6, vy: 0.15 + Math.random()*0.5, vx: (Math.random()*0.4)-0.2, alpha: 0.35 + Math.random()*0.5 });
  }
  window.addEventListener('resize', ()=>{ w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; });
  function draw(){
    ctx.clearRect(0,0,w,h);
    for(const f of flakes){
      f.x += f.vx + Math.sin(f.y/80)*0.1;
      f.y += f.vy;
      if(f.y > h + 5){ f.y = -10; f.x = Math.random()*w; }
      ctx.beginPath();
      ctx.fillStyle = `rgba(255,255,255,${f.alpha})`;
      ctx.arc(f.x, f.y, f.r, 0, Math.PI*2);
      ctx.fill();
      if(Math.random() > 0.997){
        ctx.beginPath();
        ctx.fillStyle = 'rgba(255,255,255,0.9)';
        ctx.arc(f.x + (Math.random()*6-3), f.y + (Math.random()*6-3), f.r*0.8, 0, Math.PI*2);
        ctx.fill();
      }
    }
    requestAnimationFrame(draw);
  }
  draw();
})();

const header = document.getElementById('siteHeader');
window.addEventListener('scroll', ()=>{ const s = window.scrollY; if(s > 30) header.classList.add('scrolled'); else header.classList.remove('scrolled'); });

function showSkeletonThenLoad(){
  document.getElementById('skeletonArea').style.display = 'grid';
  document.getElementById('servicesContainer').style.display = 'none';
  setTimeout(()=>{
    document.getElementById('skeletonArea').style.display = 'none';
    document.getElementById('servicesContainer').style.display = 'grid';
    buildCategories();
    renderServices();
  }, 700);
}
showSkeletonThenLoad();

let currentTheme = 'dark';
document.getElementById('themeToggle').addEventListener('click', ()=>{
  if(currentTheme === 'dark'){
    document.documentElement.style.setProperty('--bg','#f6f8fb');
    document.documentElement.style.setProperty('--panel','#ffffff');
    document.documentElement.style.setProperty('--muted','#556677');
    document.documentElement.style.setProperty('--text','#071122');
    document.documentElement.style.setProperty('--card-bg','#ffffff');
    document.documentElement.style.setProperty('--border-color','rgba(0,0,0,0.1)');
    document.getElementById('themeToggle').innerText = 'â˜€ï¸';
    currentTheme = 'light';
  } else {
    location.reload();
  }
});

</script>

</body>
</html>
