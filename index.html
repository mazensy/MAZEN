<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MAZEN â€” ط®ط¯ظ…ط§طھ ط§ظ„ط³ظˆط´ظٹط§ظ„ ط§ظ„ظ…ظ…ظٹط²ط©</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700;900&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#05050b;
  --panel:#0b1220;
  --muted:#98a6bf;
  --text:#eaf3ff;
  --accent1:#2b82ff;
  --accent2:#7a3cff;
  --accent-cta:#ffd166;
  --glass: rgba(255,255,255,0.03);
  --card-glow: 0 10px 40px rgba(58,88,255,0.12);
  --neon: 0 6px 20px rgba(123,60,255,0.12);
  --shadow: rgba(2,6,23,0.6);
  --success: #22c55e;
  --card-bg: #0f172a;
  --border-color: rgba(255,255,255,0.08);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font-family:"Tajawal",sans-serif; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  background:
    radial-gradient(800px 400px at 8% 12%, rgba(43,130,255,0.03), transparent),
    radial-gradient(600px 300px at 92% 88%, rgba(122,60,255,0.02), transparent),
    var(--bg);
  color:var(--text); overflow-x:hidden;
}
.header{
  position:sticky; top:0; z-index:1000;
  display:flex; align-items:center; justify-content:space-between;
  gap:12px; padding:14px 18px;
  backdrop-filter: blur(10px);
  background: rgba(5, 5, 11, 0.8);
  border-bottom: 1px solid var(--border-color);
  transition:background .28s ease;
}
.header.scrolled{ background: rgba(5, 5, 11, 0.95); }
.logo{display:flex; align-items:center; gap:12px}
.sym{width:48px; height:48px; border-radius:12px; display:flex; align-items:center; justify-content:center; font-weight:900; font-size:20px; color:#fff; background:linear-gradient(135deg,var(--accent1),var(--accent2)); box-shadow:var(--neon)}
.brand{font-weight:900; font-size:18px;}
.tag{color:var(--muted); font-size:12px}
.container{max-width:1200px; margin:30px auto; padding:0 18px}
.hero{display:flex; justify-content:space-between; gap:20px; align-items:center; flex-wrap:wrap; margin-bottom:20px; padding:20px 0;}
.hero h1{margin:0; font-size:28px; font-weight:900;}
.hero p{margin:8px 0 0 0; color:var(--muted); font-size:15px}
.top-offer{
  display:flex; gap:12px; align-items:center; padding:12px 18px; border-radius:12px;
  background: linear-gradient(90deg,rgba(255,209,102,0.1),rgba(122,60,255,0.1));
  border:1px solid rgba(255,209,102,0.2); color:var(--text);
  font-weight:700; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}
.top-offer small{color:var(--accent-cta); font-weight:600}
.controls{display:flex; gap:16px; align-items:center; flex-wrap:wrap; margin-bottom:20px; padding:10px 0; border-bottom:1px solid var(--border-color);}
.category-bar{display:flex; gap:10px; flex-wrap:wrap}
.cat-btn{
  display:inline-flex; align-items:center; gap:8px; padding:10px 16px; border-radius:10px; cursor:pointer; border:1px solid var(--border-color);
  background:var(--card-bg); color:var(--muted); font-weight:700; transition:all .2s ease;
  font-size:14px;
}
.cat-btn svg{filter:drop-shadow(0 4px 10px rgba(0,0,0,0.3))}
.cat-btn:hover{ border-color:var(--accent1); color:var(--text); }
.cat-btn.active{ background: linear-gradient(90deg,var(--accent1),var(--accent2)); color:#fff; box-shadow: var(--neon); border-color:var(--accent2); transform:translateY(-2px) }
.lang-filter{display:flex; gap:8px; align-items:center; margin-right:auto;}
.lang-btn{
  padding:8px 12px; border-radius:8px; background:var(--card-bg);
  border:1px solid var(--border-color); color:var(--muted); font-weight:600; cursor:pointer;
  transition:all .2s ease;
}
.lang-btn:hover{ border-color:var(--accent1); color:var(--text); }
.lang-btn.active{background:var(--accent1); color:#fff; border-color:var(--accent1); box-shadow:0 6px 20px rgba(43,130,255,0.15)}
.actions-right{margin-left:auto; display:flex; gap:8px; align-items:center}
.cards{
  display:grid; grid-template-columns:repeat(auto-fill,minmax(300px,1fr));
  gap:25px; margin-top:15px;
}
.card{
  background: var(--card-bg);
  border-radius:16px; padding:20px; border:1px solid var(--border-color);
  transition: transform .3s cubic-bezier(.2,.9,.25,1), box-shadow .3s ease;
  transform-style:preserve-3d;
  --tiltX:0deg; --tiltY:0deg;
  will-change:transform;
  position:relative; overflow:hidden;
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}
.card::after{
  content:""; position:absolute; inset:-1px; border-radius:17px; pointer-events:none;
  background:linear-gradient(90deg, transparent, rgba(123,60,255,0.1), transparent);
  opacity:0; transition:opacity .3s ease;
}
.card:hover{ transform: translateY(-5px) rotateX(var(--tiltX)) rotateY(var(--tiltY)); box-shadow: 0 20px 50px rgba(4,8,20,0.8); }
.card:hover::after{ opacity:1 }
.card-content{display:flex; justify-content:space-between; align-items:flex-start; gap:15px;}
.card .left{display:flex; gap:15px; align-items:flex-start}
.icon-wrap{width:50px;height:50px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.05); flex-shrink:0}
.card h3{margin:0 0 4px; font-size:18px; font-weight:800;}
.card .desc{color:var(--muted); font-size:14px; line-height:1.4;}
.badges{display:flex; gap:8px; margin-top:12px; flex-wrap:wrap}
.badge{padding:6px 10px; border-radius:999px; background:rgba(255,255,255,0.05); color:var(--muted); font-size:12px; border:1px solid rgba(255,255,255,0.05)}
.price{font-weight:900; color:var(--accent-cta); margin-top:15px; font-size:22px; text-align:left;}
.actions{display:flex; flex-direction:column; align-items:flex-end; gap:10px; min-width:120px; margin-top:10px;}
.btn{
  padding:10px 16px; border-radius:10px; cursor:pointer; font-weight:800; text-decoration:none; border: none;
  transition:all .2s ease;
}
.btn-wa{background:#25D366; color:#032; box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3);}
.btn-wa:hover{ background:#1EBE55; }
.btn-details{background:transparent; color:var(--muted); border:1px solid var(--border-color);}
.btn-details:hover{ background:rgba(255,255,255,0.05); color:var(--text); }

/* ========== MODAL STYLES (Fix for positioning) ========== */
.modal-bg{
  position:fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  z-index:2200;
  background:rgba(2,6,23,0.55);
  backdrop-filter:blur(8px);
  overflow-y: auto;
}
.modal-card{
  width:94%; max-width:520px;
  background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
  border-radius:16px;
  padding:20px;
  border:1px solid rgba(255,255,255,0.12);
  box-shadow:0 30px 80px rgba(0,0,0,0.6);
  position:relative;
  animation:slideUp .28s ease both;
  margin: 20px 0;
}
.modal-close{
  position:absolute; top:12px; left:12px;
  width:40px; height:40px; border-radius:50%;
  border:none; background:rgba(255,255,255,0.08); color:#fff; font-size:22px; cursor:pointer;
}
.neon{
  box-shadow: 0 0 12px rgba(0,213,255,0.14), 0 0 28px rgba(123,60,255,0.06);
  border:1px solid rgba(0,213,255,0.18);
}
.modal-card input, .modal-card select{
  width:100%; padding:12px; border-radius:10px; margin-top:6px; border:none;
  background:rgba(0,0,0,0.45); color:var(--text);
}
.price-box{
  padding:12px; border-radius:10px; background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.10); margin-top:8px; font-weight:700;
}
.confirm-box{position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:2600; background:rgba(0,0,0,0.65); backdrop-filter:blur(6px)}
.confirm-card{width:90%;max-width:420px;background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)); padding:18px;border-radius:14px;border:1px solid rgba(255,255,255,0.12); text-align:right}
.status-box{margin-top:12px;padding:10px;border-radius:10px;background:rgba(255,255,0,0.12);border:1px solid rgba(255,255,0,0.28);text-align:center}
.status-check-card{width:90%;max-width:480px;background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.08);text-align:right}
@keyframes slideUp {
  from { transform: translateY(50px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@media (max-width:768px){
  .cards{ grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); }
  .hero h1{ font-size:24px; }
  .hero p{ font-size:14px; }
  .top-offer{ display:none; }
  .lang-filter{ margin-right:0; margin-top:10px; }
  .controls{ flex-direction:column; align-items:flex-start; }
}
.small{font-size:12px;color:var(--muted)}
</style>
</head>
<body>
<div id="cursorFollow" class="cursor-follow" style="background:linear-gradient(90deg,var(--accent1),var(--accent2));width:18px;height:18px;position:fixed;left:0;top:0;border-radius:50%;pointer-events:none;z-index:2000;transform:translate(-50%,-50%);mix-blend-mode:screen;"></div>
<canvas id="particleCanvas" style="position:fixed;inset:0;z-index:1;pointer-events:none;"></canvas>
<canvas id="snowCanvas" style="position:fixed;inset:0;z-index:1;pointer-events:none;"></canvas>

<header class="header" id="siteHeader">
  <div class="logo">
    <div class="sym">M</div>
    <div>
      <div class="brand">MAZEN</div>
      <div class="tag small">ط®ط¯ظ…ط§طھ ط³ظˆط´ظٹط§ظ„ â€” Premium</div>
    </div>
  </div>
  <div style="display:flex;align-items:center;gap:10px">
    <div class="small" style="font-weight:700;">ظˆط§طھط³ط§ط¨: <strong style="color:var(--accent-cta)">+963 980 962 294</strong></div>
    <div style="display:flex;gap:8px;align-items:center">
      <button id="checkStatusBtn" class="btn" title="طھط­ظ‚ظ‚ ظ…ظ† ط­ط§ظ„ط© ط·ظ„ط¨ظƒ" style="background:transparent;border:1px solid var(--border-color);color:var(--muted);padding:8px 10px;border-radius:10px" onclick="openStatusChecker()">طھط­ظ‚ظ‚ ظ…ظ† ط§ظ„ط·ظ„ط¨</button>
      <button id="themeToggle" class="btn" title="طھط¨ط¯ظٹظ„ ط§ظ„ط«ظٹظ…" style="background:transparent;border:1px solid var(--border-color);color:var(--muted);padding:8px 10px;border-radius:10px">ًںŒ™</button>
    </div>
  </div>
</header>

<main class="container">
  <section class="hero">
    <div>
      <h1>MAZEN â€” ط®ط¯ظ…ط§طھ ط§ظ„ط³ظˆط´ظٹط§ظ„ (Premium)</h1>
      <p>ظˆط§ط¬ظ‡ط© ط¯ط§ظƒظ†ط© ظپط§ط®ط±ط© â€” طھط­ظƒظ… ط¨ظƒظ„ ط§ظ„ط®ط¯ظ…ط§طھ ظˆط§ظ„ظ…ط¤ط«ط±ط§طھ. ط§ط¶ط؛ط· ط¹ظ„ظ‰ ط£ظٹ ط®ط¯ظ…ط© ظ„ط·ظ„ط¨ظ‡ط§ ط¹ط¨ط± ط§ظ„ظ†ط¸ط§ظ… ط§ظ„ط¬ط¯ظٹط¯.</p>
    </div>
    <div class="top-offer">
      <svg width="24" height="24" viewBox="0 0 24 24" style="filter:drop-shadow(0 6px 20px rgba(0,0,0,0.4))"><path d="M12 2l2.6 6.9L21 9.2l-5 3.7L17 20l-5-3.3L7 20l1-7.1-5-3.7 6.4-0.3L12 2z" fill="#ffd166"/></svg>
      <div style="line-height:1.2">
        <div style="font-size:16px;">ط¹ط±ظˆط¶ ظ†ظ‡ط§ظٹط© ط§ظ„ط³ظ†ط©</div>
        <small style="font-size:13px;">ط®طµظˆظ…ط§طھ ط¹ظ„ظ‰ ط¨ط§ظ‚ط§طھ ط§ظ„ظ…طھط§ط¨ط¹ظٹظ† â€” ط§ط·ظ„ط¨ ط§ظ„ط¢ظ†</small>
      </div>
    </div>
  </section>

  <div class="controls">
    <div class="category-bar" id="categoryBar" role="tablist" aria-label="ظ…ظ†طµط§طھ ط§ظ„طھظˆط§طµظ„"></div>
    <div class="lang-filter">
      <button id="lg_all" class="lang-btn active" onclick="setLang('all')">ط§ظ„ظƒظ„</button>
      <button id="lg_ar" class="lang-btn" onclick="setLang('arabic')">ط¹ط±ط¨ظٹ</button>
      <button id="lg_en" class="lang-btn" onclick="setLang('foreign')">ط£ط¬ظ†ط¨ظٹ</button>
    </div>
  </div>

  <div id="skeletonArea" class="cards" aria-hidden="false">
    <div class="card skel" style="height:150px;background:linear-gradient(90deg,#0f172a,#1e293b,#0f172a); animation: pulse 1.5s infinite;"></div>
    <div class="card skel" style="height:150px;background:linear-gradient(90deg,#0f172a,#1e293b,#0f172a); animation: pulse 1.5s infinite 0.2s;"></div>
    <div class="card skel" style="height:150px;background:linear-gradient(90deg,#0f172a,#1e293b,#0f172a); animation: pulse 1.5s infinite 0.4s;"></div>
    <div class="card skel" style="height:150px;background:linear-gradient(90deg,#0f172a,#1e293b,#0f172a); animation: pulse 1.5s infinite 0.6s;"></div>
  </div>
  <style>@keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }</style>

  <div id="servicesContainer" class="cards" style="display:none"></div>
</main>

<div id="orderModal" class="modal-bg" aria-hidden="true">
  <div class="modal-card neon">
    <button class="modal-close" onclick="closeOrder()">أ—</button>
    <h2 id="modalTitle" style="margin-top:0;margin-bottom:15px;font-size:20px;">ط·ظ„ط¨ ط®ط¯ظ…ط©:</h2>
    <div style="line-height:1.8;font-size:14px;color:var(--muted)">
      <div id="modalDesc"></div>
      <div id="modalMinMax" style="margin-top:8px;"></div>
    </div>
    <div style="margin-top:20px">
      <label for="orderLinkAuto" style="font-weight:700;font-size:14px;">ط±ط§ط¨ط· ط§ظ„ط­ط³ط§ط¨/ط§ظ„ظ…ظ†ط´ظˆط±:</label>
      <input type="text" id="orderLinkAuto" placeholder="ط£ط¯ط®ظ„ ط§ظ„ط±ط§ط¨ط· ظ‡ظ†ط§" required>
    </div>
    <div style="margin-top:15px">
      <label for="orderQty" style="font-weight:700;font-size:14px;">ط§ظ„ظƒظ…ظٹط© ط§ظ„ظ…ط·ظ„ظˆط¨ط©:</label>
      <input type="number" id="orderQty" placeholder="ط§ظ„ط­ط¯ ط§ظ„ط£ط¯ظ†ظ‰ 100" required>
    </div>
    <div style="margin-top:15px">
      <label for="paymentMethodAuto" style="font-weight:700;font-size:14px;">ط·ط±ظٹظ‚ط© ط§ظ„ط¯ظپط¹:</label>
      <select id="paymentMethodAuto">
        <option value="syr">ط³ظٹط±ظٹطھظ„ ظƒط§ط´</option>
        <option value="sham">ط´ط§ظ… ظƒط§ط´ (ظƒظˆط¯)</option>
      </select>
    </div>

    <div class="price-box">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <span style="font-size:14px;color:var(--muted)">ط§ظ„طھظƒظ„ظپط© ط§ظ„طھظ‚ط¯ظٹط±ظٹط©:</span>
        <span id="totalPrice" style="font-size:24px;color:var(--accent-cta);font-weight:900;">0 ظ„.ط³</span>
      </div>
    </div>
    <button onclick="confirmAndSend()" style="margin-top:20px;padding:12px 20px;border:none;border-radius:10px;background:var(--accent2);color:#fff;font-size:16px;cursor:pointer;width:100%;font-weight:800;box-shadow:0 6px 20px rgba(122,60,255,0.3);">طھط£ظƒظٹط¯ ط§ظ„ط·ظ„ط¨ ظˆط§ظ„ظ…طھط§ط¨ط¹ط©</button>
  </div>
</div>

<div id="confirmBox" class="confirm-box" aria-hidden="true">
  <div id="confirmCard" class="confirm-card"></div>
</div>

<div id="statusChecker" class="modal-bg" aria-hidden="true">
  <div class="modal-card">
    <button class="modal-close" onclick="closeStatusChecker()">أ—</button>
    <h2 style="margin-top:0;margin-bottom:15px;font-size:20px;">طھط­ظ‚ظ‚ ظ…ظ† ط­ط§ظ„ط© ط§ظ„ط·ظ„ط¨</h2>
    <div style="margin-top:20px">
      <label for="statusOrderId" style="font-weight:700;font-size:14px;">ظ…ط¹ط±ظپ ط§ظ„ط·ظ„ط¨:</label>
      <input type="number" id="statusOrderId" placeholder="ط£ط¯ط®ظ„ ظ…ط¹ط±ظپ ط§ظ„ط·ظ„ط¨ ظ‡ظ†ط§" required>
    </div>
    <button onclick="checkOrderStatus()" style="margin-top:15px;padding:12px 20px;border:none;border-radius:10px;background:var(--accent1);color:#fff;font-size:16px;cursor:pointer;width:100%;font-weight:800;">طھط­ظ‚ظ‚</button>
    <div id="statusResult" class="status-box" style="display:none; margin-top:15px; background:rgba(43,130,255,0.1); border-color:rgba(43,130,255,0.3);"></div>
  </div>
</div>

<audio id="successSound" src="https://www.soundjay.com/button/button-3.mp3" preload="auto"></audio>

<script>
// ==================================================================================
// ==================== ظ…ظ†ط·ظ‚ط© ط§ظ„طھط¹ط¯ظٹظ„ ط§ظ„ط³ظ‡ظ„ ظ„ظ„ط£ظ‚ط³ط§ظ… ظˆط§ظ„ط®ط¯ظ…ط§طھ ====================
// ==================================================================================

const WA_NUMBER = '963980962294';
const SYRITEL_NUMBER = '0980962294';
const SHAM_CODE = 'XXXXXX';
const USD_TO_SYP_RATE = 15000;

const CATEGORIES = [
  { id: 'instagram', title: 'ط§ظ†ط³طھط¬ط±ط§ظ…', icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg>' },
  { id: 'tiktok', title: 'طھظٹظƒ طھظˆظƒ', icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.04 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>' },
  { id: 'telegram', title: 'طھظ„ظٹط¬ط±ط§ظ…', icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 11-9 11s-9-4-9-11a9 9 0 0 1 18 0z"></path><polyline points="12 2 12 12"></polyline></svg>' },
  { id: 'youtube', title: 'ظٹظˆطھظٹظˆط¨', icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.42a2.78 2.78 0 0 0-1.94 2C2 8.16 2 12 2 12s0 3.84.46 5.58a2.78 2.78 0 0 0 1.94 2C5.12 20 12 20 12 20s6.88 0 8.6-.42a2.78 2.78 0 0 0 1.94-2C22 15.84 22 12 22 12s0-3.84-.46-5.58z"></path><polygon points="10 15 15 12 10 9 10 15"></polygon></svg>' },
  { id: 'facebook', title: 'ظپظٹط³ط¨ظˆظƒ', icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>' },
  { id: 'twitter', title: 'طھظˆظٹطھط±', icon: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>' },
];

const SERVICES = [
  { id: 1, cat: 'instagram', title: 'ظ…طھط§ط¨ط¹ظٹظ† ط§ظ†ط³طھط¬ط±ط§ظ… (ط¹ط±ط¨ظٹ)', desc: 'ظ…طھط§ط¨ط¹ظٹظ† ط¹ط±ط¨ ط­ظ‚ظٹظ‚ظٹظٹظ† ظˆظ…ط¶ظ…ظˆظ†ظٹظ†طŒ ط³ط±ط¹ط© ط¹ط§ظ„ظٹط©.', price: 1.2, lang: 'ar', min: 100, max: 100000, speed: 'ط³ط±ظٹط¹', quality: 'ط¹ط§ظ„ظٹ' },
  { id: 2, cat: 'instagram', title: 'ظ…طھط§ط¨ط¹ظٹظ† ط§ظ†ط³طھط¬ط±ط§ظ… (ط£ط¬ظ†ط¨ظٹ)', desc: 'ظ…طھط§ط¨ط¹ظٹظ† ط£ط¬ط§ظ†ط¨ ط¨ط¬ظˆط¯ط© ط¹ط§ظ„ظٹط©طŒ ط¨ط¯ط، ظپظˆط±ظٹ.', price: 0.8, lang: 'en', min: 100, max: 100000, speed: 'ظ…طھظˆط³ط·', quality: 'ط¹ط§ط¯ظٹ' },
  { id: 3, cat: 'instagram', title: 'ظ„ط§ظٹظƒط§طھ ط§ظ†ط³طھط¬ط±ط§ظ… (ط¹ط±ط¨ظٹ)', desc: 'ظ„ط§ظٹظƒط§طھ ط¹ط±ط¨ظٹط© ط¹ظ„ظ‰ ط§ظ„ظ…ظ†ط´ظˆط±ط§طھطŒ ط«ط§ط¨طھط©.', price: 0.5, lang: 'ar', min: 50, max: 50000, speed: 'ط³ط±ظٹط¹', quality: 'ط¹ط§ظ„ظٹ' },
  { id: 4, cat: 'instagram', title: 'ظ…ط´ط§ظ‡ط¯ط§طھ ط±ظٹظ„ط² ط§ظ†ط³طھط¬ط±ط§ظ…', desc: 'ظ…ط´ط§ظ‡ط¯ط§طھ ط³ط±ظٹط¹ط© ط¬ط¯ط§ظ‹ ظ„ظ„ط±ظٹظ„ط²طŒ ط¬ظˆط¯ط© ظ…ظ…طھط§ط²ط©.', price: 0.1, lang: 'en', min: 1000, max: 500000, speed: 'ظپظˆط±ظٹ', quality: 'ط¹ط§ظ„ظٹ' },
  { id: 5, cat: 'tiktok', title: 'ظ…طھط§ط¨ط¹ظٹظ† طھظٹظƒ طھظˆظƒ (ط¹ط±ط¨ظٹ)', desc: 'ظ…طھط§ط¨ط¹ظٹظ† ط¹ط±ط¨ ط­ظ‚ظٹظ‚ظٹظٹظ†طŒ ط¶ظ…ط§ظ† طھط¹ظˆظٹط¶.', price: 1.5, lang: 'ar', min: 100, max: 50000, speed: 'ظ…طھظˆط³ط·', quality: 'ط¹ط§ظ„ظٹ' },
  { id: 6, cat: 'tiktok', title: 'ظ…طھط§ط¨ط¹ظٹظ† طھظٹظƒ طھظˆظƒ (ط£ط¬ظ†ط¨ظٹ)', desc: 'ظ…طھط§ط¨ط¹ظٹظ† ط£ط¬ط§ظ†ط¨طŒ ط¬ظˆط¯ط© ط¹ط§ظ„ظٹط© ط¬ط¯ط§ظ‹.', price: 1.0, lang: 'en', min: 100, max: 100000, speed: 'ط³ط±ظٹط¹', quality: 'ط¹ط§ظ„ظٹ' },
  { id: 7, cat: 'tiktok', title: 'ظ„ط§ظٹظƒط§طھ طھظٹظƒ طھظˆظƒ', desc: 'ظ„ط§ظٹظƒط§طھ ط¹ظ„ظ‰ ط§ظ„ظپظٹط¯ظٹظˆظ‡ط§طھطŒ ط¨ط¯ط، ظپظˆط±ظٹ.', price: 0.6, lang: 'en', min: 50, max: 50000, speed: 'ظپظˆط±ظٹ', quality: 'ط¹ط§ط¯ظٹ' },
  { id: 8, cat: 'telegram', title: 'ط£ط¹ط¶ط§ط، ظ‚ظ†ط§ط© طھظ„ظٹط¬ط±ط§ظ… (ط¹ط±ط¨ظٹ)', desc: 'ط£ط¹ط¶ط§ط، ط¹ط±ط¨ ط­ظ‚ظٹظ‚ظٹظٹظ† ظ„ظ‚ظ†ط§طھظƒطŒ ط«ط§ط¨طھظٹظ†.', price: 2.0, lang: 'ar', min: 50, max: 10000, speed: 'ظ…طھظˆط³ط·', quality: 'ط¹ط§ظ„ظٹ' },
  { id: 9, cat: 'telegram', title: 'ظ…ط´ط§ظ‡ط¯ط§طھ ظ…ظ†ط´ظˆط±ط§طھ طھظ„ظٹط¬ط±ط§ظ…', desc: 'ظ…ط´ط§ظ‡ط¯ط§طھ ط³ط±ظٹط¹ط© ط¬ط¯ط§ظ‹ ظ„ظ„ظ…ظ†ط´ظˆط±ط§طھ.', price: 0.2, lang: 'en', min: 1000, max: 200000, speed: 'ظپظˆط±ظٹ', quality: 'ط¹ط§ط¯ظٹ' },
  { id: 10, cat: 'youtube', title: 'ظ…ط´طھط±ظƒظٹظ† ظٹظˆطھظٹظˆط¨', desc: 'ظ…ط´طھط±ظƒظٹظ† ط­ظ‚ظٹظ‚ظٹظٹظ†طŒ ط¶ظ…ط§ظ† 30 ظٹظˆظ….', price: 5.0, lang: 'en', min: 10, max: 1000, speed: 'ط¨ط·ظٹط،', quality: 'ط¹ط§ظ„ظٹ' },
  { id: 11, cat: 'youtube', title: 'ظ…ط´ط§ظ‡ط¯ط§طھ ظٹظˆطھظٹظˆط¨', desc: 'ظ…ط´ط§ظ‡ط¯ط§طھ ط¹ط§ظ„ظٹط© ط§ظ„ط¬ظˆط¯ط©طŒ ط«ط§ط¨طھط©.', price: 0.9, lang: 'en', min: 1000, max: 500000, speed: 'ط³ط±ظٹط¹', quality: 'ط¹ط§ظ„ظٹ' },
  { id: 12, cat: 'facebook', title: 'ظ…طھط§ط¨ط¹ظٹظ† طµظپط­ط© ظپظٹط³ط¨ظˆظƒ (ط¹ط±ط¨ظٹ)', desc: 'ظ…طھط§ط¨ط¹ظٹظ† ط¹ط±ط¨ ط­ظ‚ظٹظ‚ظٹظٹظ† ظ„ظ„طµظپط­ط©.', price: 1.8, lang: 'ar', min: 100, max: 20000, speed: 'ظ…طھظˆط³ط·', quality: 'ط¹ط§ظ„ظٹ' },
  { id: 13, cat: 'facebook', title: 'ظ„ط§ظٹظƒط§طھ ظ…ظ†ط´ظˆط± ظپظٹط³ط¨ظˆظƒ', desc: 'ظ„ط§ظٹظƒط§طھ ط¹ط±ط¨ظٹط© ط¹ظ„ظ‰ ط§ظ„ظ…ظ†ط´ظˆط±ط§طھ.', price: 0.7, lang: 'ar', min: 50, max: 10000, speed: 'ط³ط±ظٹط¹', quality: 'ط¹ط§ط¯ظٹ' },
  { id: 14, cat: 'twitter', title: 'ظ…طھط§ط¨ط¹ظٹظ† طھظˆظٹطھط± (ط£ط¬ظ†ط¨ظٹ)', desc: 'ظ…طھط§ط¨ط¹ظٹظ† ط£ط¬ط§ظ†ط¨طŒ ط¬ظˆط¯ط© ط¹ط§ظ„ظٹط©.', price: 1.1, lang: 'en', min: 100, max: 50000, speed: 'ظ…طھظˆط³ط·', quality: 'ط¹ط§ظ„ظٹ' },
];

let currentCategory = CATEGORIES[0].id;
let currentLang = 'all';
let currentServiceId = null;
let currentPriceUSD = 0;
let orderCounter = Number(localStorage.getItem('mazen_order_counter') || 1000);

function esc(str){ if(!str) return ''; return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/'/g, '&#039;'); }
function pricePer1000SYP(priceUSD){ return Math.ceil(priceUSD * USD_TO_SYP_RATE); }

function buildCategories(){
  const bar = document.getElementById('categoryBar');
  bar.innerHTML = CATEGORIES.map(c => {
    const isActive = c.id === currentCategory ? 'active' : '';
    return `<button class="cat-btn ${isActive}" onclick="setCategory('${c.id}')" role="tab" aria-selected="${isActive ? 'true' : 'false'}">
      ${c.icon}
      <span>${c.title}</span>
    </button>`;
  }).join('');
}

function setCategory(cat){
  currentCategory = cat;
  document.querySelectorAll('.cat-btn').forEach(b=>b.classList.remove('active'));
  document.querySelector(`.cat-btn[onclick="setCategory('${cat}')"]`).classList.add('active');
  renderServices();
}

function setLang(lang){
  currentLang = lang;
  document.querySelectorAll('.lang-btn').forEach(b=>b.classList.remove('active'));
  let idSuffix = '';
  if(lang === 'all') idSuffix = 'all';
  else if(lang === 'arabic') idSuffix = 'ar';
  else if(lang === 'foreign') idSuffix = 'en';
  const activeBtn = document.getElementById('lg_'+idSuffix);
  if(activeBtn) activeBtn.classList.add('active');
  renderServices();
}

function renderServices(){
  const container = document.getElementById('servicesContainer');
  const filteredByCategory = SERVICES.filter(s => s.cat === currentCategory);
  const filteredByLang = filteredByCategory.filter(s => {
    const serviceLang = s.lang ? s.lang.toLowerCase() : 'unknown';
    if(currentLang === 'all') return true;
    if(currentLang === 'arabic' && serviceLang === 'ar') return true;
    if(currentLang === 'foreign' && serviceLang === 'en') return true;
    return false;
  });
  
  if(filteredByLang.length === 0){
    container.innerHTML = `<div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: var(--muted); font-size: 18px; background: var(--card-bg); border-radius: 12px; border: 1px solid var(--border-color);">
      ظ„ط§ طھظˆط¬ط¯ ط®ط¯ظ…ط§طھ ظ…طھط§ط­ط© ط­ط§ظ„ظٹط§ظ‹ ظپظٹ ظ‡ط°ط§ ط§ظ„ظ‚ط³ظ… ط¨ط§ظ„ظ„ط؛ط© ط§ظ„ظ…ط­ط¯ط¯ط©.
    </div>`;
    return;
  }
  
  container.innerHTML = filteredByLang.map(s => {
    const icon = CATEGORIES.find(c => c.id === s.cat)?.icon || '';
    const priceSYP = pricePer1000SYP(s.price);
    
    return `
      <div class="card" onclick="openOrder(${s.id})">
        <div class="card-content">
          <div class="left">
            <div class="icon-wrap">${icon}</div>
            <div>
              <h3>${esc(s.title)}</h3>
              <p class="desc">${esc(s.desc)}</p>
              <div class="badges">
                <span class="badge">ط§ظ„ط³ط±ط¹ط©: ${esc(s.speed)}</span>
                <span class="badge">ط§ظ„ط¬ظˆط¯ط©: ${esc(s.quality)}</span>
                <span class="badge">ط§ظ„ط­ط¯ ط§ظ„ط£ط¯ظ†ظ‰: ${s.min.toLocaleString()}</span>
              </div>
            </div>
          </div>
          <div class="actions">
            <div class="price">${priceSYP.toLocaleString()} ظ„.ط³ / 1000</div>
            <button class="btn btn-wa" onclick="event.stopPropagation(); openOrder(${s.id})">ط§ط·ظ„ط¨ ط§ظ„ط¢ظ†</button>
            <button class="btn btn-details" onclick="event.stopPropagation(); openOrder(${s.id})">ط§ظ„طھظپط§طµظٹظ„</button>
          </div>
        </div>
      </div>
    `;
  }).join('');
  
  if(EFFECTS.tilt){
    document.querySelectorAll('.card').forEach(card => {
      card.addEventListener('mousemove', handleTilt);
      card.addEventListener('mouseleave', resetTilt);
    });
  }
}

function handleTilt(e){
  const card = e.currentTarget;
  const rect = card.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;
  const centerX = rect.width / 2;
  const centerY = rect.height / 2;
  const tiltX = (centerY - y) / 15;
  const tiltY = (x - centerX) / 15;
  card.style.setProperty('--tiltX', `${tiltX}deg`);
  card.style.setProperty('--tiltY', `${tiltY}deg`);
}

function resetTilt(e){
  const card = e.currentTarget;
  card.style.setProperty('--tiltX', '0deg');
  card.style.setProperty('--tiltY', '0deg');
}

function openOrder(serviceId){
  const service = SERVICES.find(s => s.id === serviceId);
  if(!service) return;
  
  currentServiceId = serviceId;
  currentPriceUSD = service.price;
  
  document.getElementById('modalTitle').innerText = `ط·ظ„ط¨ ط®ط¯ظ…ط©: ${service.title}`;
  document.getElementById('modalDesc').innerHTML = `<strong>ط§ظ„ظˆطµظپ:</strong> ${service.desc}`;
  document.getElementById('modalMinMax').innerHTML = `<strong>ط§ظ„ط­ط¯ظˆط¯:</strong> ظ…ظ† ${service.min.toLocaleString()} ط¥ظ„ظ‰ ${service.max.toLocaleString()} - <strong>ط§ظ„ط³ط¹ط±:</strong> ${pricePer1000SYP(service.price).toLocaleString()} ظ„.ط³ / 1000`;
  
  const lastOrder = JSON.parse(localStorage.getItem('mazen_last_order') || '{}');
  document.getElementById('orderQty').value = lastOrder.qty || service.min;
  document.getElementById('orderLinkAuto').value = lastOrder.link || '';

  document.getElementById('paymentMethodAuto').value = lastOrder.method || 'syr';
  
  updatePrice();
  
  document.getElementById('orderModal').style.display = 'flex';
  document.getElementById('orderModal').setAttribute('aria-hidden','false');
}

function closeOrder(){
  document.getElementById('orderModal').style.display = 'none';
  document.getElementById('orderModal').setAttribute('aria-hidden','true');
}

function updatePrice(){
  const qty = Number(document.getElementById('orderQty').value || 0);
  const basePer1000 = pricePer1000SYP(currentPriceUSD);
  const total = Math.ceil((qty/1000) * basePer1000);
  document.getElementById('totalPrice').innerText = `${total.toLocaleString()} ظ„.ط³`;
}

document.getElementById('orderQty').addEventListener('input', updatePrice);

function validateInputs(checkTransferCode = true){
  const service = SERVICES.find(s => s.id === currentServiceId);
  if(!service) return false;
  
  const link = document.getElementById('orderLinkAuto').value.trim();
  const qty = Number(document.getElementById('orderQty').value || 0);
  const code = ''; // طھظ… ط¥ط²ط§ظ„ط© ط§ظ„ط­ظ‚ظ„ ظ…ظ† ط§ظ„ظ†ط§ظپط°ط© ط§ظ„ط£ظˆظ„ظ‰
  
  if(!link){ alert('ظٹط±ط¬ظ‰ ط¥ط¯ط®ط§ظ„ ط±ط§ط¨ط· ط§ظ„ط­ط³ط§ط¨ ط£ظˆ ط§ظ„ظ…ظ†ط´ظˆط±'); return false; }
  if(!qty || qty < service.min){ alert(`ط§ظ„ط­ط¯ ط§ظ„ط£ط¯ظ†ظ‰ ظ„ظ„ظƒظ…ظٹط© ظ‡ظˆ ${service.min.toLocaleString()}`); return false; }
  if(qty > service.max){ alert(`ط§ظ„ط­ط¯ ط§ظ„ط£ظ‚طµظ‰ ظ„ظ„ظƒظ…ظٹط© ظ‡ظˆ ${service.max.toLocaleString()}`); return false; }
  
  return true;
}

function saveOrderObject(order){
  const raw = localStorage.getItem('mazen_orders');
  const arr = raw ? JSON.parse(raw) : [];
  arr.push(order);
  localStorage.setItem('mazen_orders', JSON.stringify(arr));
  localStorage.setItem('mazen_order_counter', String(order.orderId));
}

function copyToClipboard(text, elId) {
  // Fallback for non-secure contexts or older browsers
  if (!navigator.clipboard) {
    const textarea = document.createElement('textarea');
    textarea.value = text;
    document.body.appendChild(textarea);
    textarea.select();
    try {
      document.execCommand('copy');
      const el = document.getElementById(elId);
      const originalText = el.innerText;
      el.innerText = 'طھظ… ط§ظ„ظ†ط³ط®!';
      setTimeout(() => { el.innerText = originalText; }, 1500);
    } catch (err) {
      console.error('Could not copy text: ', err);
      alert('ظپط´ظ„ ط§ظ„ظ†ط³ط®طŒ ظٹط±ط¬ظ‰ ط§ظ„ظ†ط³ط® ظٹط¯ظˆظٹط§ظ‹: ' + text);
    }
    document.body.removeChild(textarea);
    return;
  }
  
  // Modern approach
  navigator.clipboard.writeText(text).then(() => {
    const el = document.getElementById(elId);
    const originalText = el.innerText;
    el.innerText = 'طھظ… ط§ظ„ظ†ط³ط®!';
    setTimeout(() => { el.innerText = originalText; }, 1500);
  }).catch(err => {
    console.error('Could not copy text: ', err);
    alert('ظپط´ظ„ ط§ظ„ظ†ط³ط®طŒ ظٹط±ط¬ظ‰ ط§ظ„ظ†ط³ط® ظٹط¯ظˆظٹط§ظ‹: ' + text);
  });
}

function confirmAndSend(){
  if(!validateInputs(false)) return;
  
  const link = document.getElementById('orderLinkAuto').value.trim();
  const qty = Number(document.getElementById('orderQty').value || 0);
  const code = ''; // طھظ… ط¥ط²ط§ظ„ط© ط§ظ„ط­ظ‚ظ„ ظ…ظ† ط§ظ„ظ†ط§ظپط°ط© ط§ظ„ط£ظˆظ„ظ‰
  const pay = document.getElementById('paymentMethodAuto').value;
  
  const basePer1000 = pricePer1000SYP(currentPriceUSD);
  const total = Math.ceil((qty/1000) * basePer1000);
  
  const id = ++orderCounter;
  
  const service = SERVICES.find(x=>x.id === currentServiceId) || {title: 'â€”'};
  const orderObj = {
    orderId: id,
    serviceId: currentServiceId,
    serviceTitle: service.title,
    qty: qty,
    total_lira: total,
    link: link,
    transfer_code: code,
    payment_method: pay,
    status: 'ظ‚ظٹط¯ ط§ظ„ظ…ط±ط§ط¬ط¹ط©',
    created_at: new Date().toISOString()
  };
  
  localStorage.setItem('mazen_last_order', JSON.stringify({qty, link, method: pay}));
  saveOrderObject(orderObj);
  
  try{ document.getElementById('successSound').currentTime = 0; document.getElementById('successSound').play(); }catch(e){}
  
  const paymentMethod = orderObj.payment_method;
  let paymentValue = '';
  let paymentLabel = '';
  let paymentName = '';
  
  if (paymentMethod === 'syr') {
    paymentValue = SYRITEL_NUMBER;
    paymentLabel = 'ط±ظ‚ظ… ط³ظٹط±ظٹطھظ„ ظƒط§ط´';
    paymentName = 'ط³ظٹط±ظٹطھظ„ ظƒط§ط´';
  } else if (paymentMethod === 'sham') {
    paymentValue = SHAM_CODE;
    paymentLabel = 'ظƒظˆط¯ ط´ط§ظ… ظƒط§ط´';
    paymentName = 'ط´ط§ظ… ظƒط§ط´';
  }

  const paymentDetailsHTML = `
    <div style="margin-top:18px; padding-top:15px; border-top:1px solid var(--border-color);">
      <h3 style="margin:0 0 10px; font-size:16px; color:var(--accent-cta);">ط®ط·ظˆط§طھ ط§ظ„ط¯ظپط¹:</h3>
      <p style="margin:0 0 10px; font-size:14px; color:var(--muted);">ظٹط±ط¬ظ‰ طھط­ظˆظٹظ„ ظ…ط¨ظ„ط؛ <strong>${orderObj.total_lira.toLocaleString()} ظ„.ط³</strong> ط¥ظ„ظ‰ ${paymentName} ط¨ط§ط³طھط®ط¯ط§ظ… ط§ظ„طھظپط§طµظٹظ„ ط§ظ„طھط§ظ„ظٹط©:</p>
      <div style="display:flex; align-items:center; justify-content:space-between; background:var(--card-bg); padding:10px; border-radius:8px; border:1px solid var(--border-color);">
        <span style="font-weight:700; font-size:16px; color:var(--text);" id="paymentValue">${paymentValue}</span>
        <button id="copyBtn" onclick="copyToClipboard('${paymentValue}', 'copyBtn')" style="padding:8px 12px; border-radius:6px; border:none; background:var(--accent1); color:#fff; font-weight:700; cursor:pointer; transition:background .2s ease;">ظ†ط³ط®</button>
      </div>
      <p style="margin:10px 0 0 0; font-size:13px; color:var(--muted);">ظٹط±ط¬ظ‰ ط¥طھظ…ط§ظ… ط¹ظ…ظ„ظٹط© ط§ظ„طھط­ظˆظٹظ„ ط£ظˆظ„ط§ظ‹. ط¨ط¹ط¯ ط§ظ„طھط­ظˆظٹظ„طŒ ط³طھط­طµظ„ ط¹ظ„ظ‰ ظƒظˆط¯ ط§ظ„ط¹ظ…ظ„ظٹط© ط§ظ„ط°ظٹ ظٹط¬ط¨ ط¥ط¯ط®ط§ظ„ظ‡ ظپظٹ ط§ظ„ط£ط³ظپظ„ ظ„ظ„ظ…طھط§ط¨ط¹ط© ط¥ظ„ظ‰ ظˆط§طھط³ط§ط¨.</p>
    </div>
  `;

  const confirmHTML = `
    <h2 style="margin-top:0;margin-bottom:12px;color:var(--success)">âœ” طھظ… ط§ط³طھظ„ط§ظ… ط·ظ„ط¨ظƒ</h2>
    <div class="status-box" style="background:rgba(34,197,94,0.12); border-color:rgba(34,197,94,0.28);">ط§ظ„ط­ط§ظ„ط©: <strong>${orderObj.status}</strong></div>
    <div style="text-align:right;line-height:2;margin-top:18px;font-size:15px;border-top:1px solid var(--border-color); padding-top:15px;">
      <b>ط§ظ„ظ…ط¹ط±ظپ:</b> <span style="color:var(--accent-cta); font-size:18px;">${orderObj.orderId}</span><br>
      <b>ط§ظ„ط®ط¯ظ…ط©:</b> ${esc(orderObj.serviceTitle)}<br>
      <b>ط§ظ„ط±ط§ط¨ط·:</b> ${esc(orderObj.link)}<br>
      <b>ط§ظ„ظƒظ…ظٹط©:</b> ${orderObj.qty.toLocaleString()}<br>
      <b>ط§ظ„طھظƒظ„ظپط©:</b> ${orderObj.total_lira.toLocaleString()} ظ„.ط³
    </div>
    ${paymentDetailsHTML}
<div style="margin-top:18px;font-size:13px;color:var(--muted); border-bottom:1px solid var(--border-color); padding-bottom:15px;">
	      ط§ط­طھظپط¸ ط¨ط§ظ„ظ…ط¹ط±ظپ ظ„طھطھط¨ط¹ ط­ط§ظ„ط© ط§ظ„ط·ظ„ط¨ ظ„ط§ط­ظ‚ظ‹ط§.
	    </div>
	    <div id="transferCodeArea" style="margin-top:20px; padding:15px; border-radius:10px; background:rgba(255,209,102,0.1); border:1px solid rgba(255,209,102,0.2);">
	      <p style="font-weight:700; margin-top:0; color:var(--text);">ط§ظ„ط®ط·ظˆط© ط§ظ„ط£ط®ظٹط±ط©: طھط£ظƒظٹط¯ ط§ظ„ط¯ظپط¹</p>
	      <p style="font-size:13px; color:var(--muted); margin:4px 0 10px;">ط¨ط¹ط¯ ط¥طھظ…ط§ظ… ط§ظ„طھط­ظˆظٹظ„طŒ ط£ط¯ط®ظ„ ظƒظˆط¯ ط§ظ„ط¹ظ…ظ„ظٹط© ط§ظ„ط°ظٹ ظˆطµظ„ظƒ ط¨ط±ط³ط§ظ„ط© ظ†طµظٹط© ط«ظ… ط§ط¶ط؛ط· ط¹ظ„ظ‰ ط§ظ„ط²ط± ظ„ظ„ط¥ط±ط³ط§ظ„.</p>
	      <input type="text" id="finalTransferCode" placeholder="ط£ط¯ط®ظ„ ظƒظˆط¯ ط¹ظ…ظ„ظٹط© ط§ظ„طھط­ظˆظٹظ„ ظ‡ظ†ط§" style="width:100%; padding:10px; border-radius:8px; margin-top:8px; border:1px solid var(--border-color); background:var(--card-bg); color:var(--text);">
	      <button onclick="sendWA(${orderObj.orderId})"
	        style="margin-top:15px;padding:12px 20px;border:none;border-radius:10px;background:#25D366;color:#032;font-size:16px;cursor:pointer;width:100%;font-weight:800;">ط¥ط±ط³ط§ظ„ ط§ظ„طھظپط§طµظٹظ„ ظˆظƒظˆط¯ ط§ظ„طھط­ظˆظٹظ„ ط¥ظ„ظ‰ ظˆط§طھط³ط§ط¨</button>
	    </div>
  `;
  document.getElementById('confirmCard').innerHTML = confirmHTML;
  document.getElementById('confirmBox').style.display = 'flex';
  document.getElementById('confirmBox').setAttribute('aria-hidden','false');
  
  document.getElementById('orderModal').style.display = 'none';
  document.getElementById('orderModal').setAttribute('aria-hidden','true');
}

function sendWA(orderId){
  const finalCode = document.getElementById('finalTransferCode').value.trim();
  if(!finalCode){
    alert('ظٹط±ط¬ظ‰ ط¥ط¯ط®ط§ظ„ ظƒظˆط¯ ط¹ظ…ظ„ظٹط© ط§ظ„طھط­ظˆظٹظ„ ط§ظ„ط°ظٹ ظˆطµظ„ظƒ ط¨ط¹ط¯ ط§ظ„ط¯ظپط¹ ظ„ظ„ظ…طھط§ط¨ط¹ط©.');
    return;
  }
  
  const arr = JSON.parse(localStorage.getItem('mazen_orders') || '[]');
  let o = arr.find(x=>x.orderId === orderId);
  
  if(!o){
    alert('ط®ط·ط£: ظ„ظ… ظ†طھظ…ظƒظ† ظ…ظ† ط§ظ„ط¹ط«ظˆط± ط¹ظ„ظ‰ ط§ظ„ط·ظ„ط¨ ظ„ط¥ط±ط³ط§ظ„ظ‡.');
    return;
  }
  
  // طھط­ط¯ظٹط« ظƒظˆط¯ ط§ظ„طھط­ظˆظٹظ„ ظپظٹ ط§ظ„ط·ظ„ط¨ ط§ظ„ظ…ط®ط²ظ† ظ…ط­ظ„ظٹط§ظ‹
  o.transfer_code = finalCode;
  localStorage.setItem('mazen_orders', JSON.stringify(arr));
  
  const paymentInfo = o.payment_method === 'syr' ? `ط³ظٹط±ظٹطھظ„ ظƒط§ط´: ${SYRITEL_NUMBER}` : `ط´ط§ظ… ظƒط§ط´ (ظƒظˆط¯): ${SHAM_CODE}`;
  const msg = `ًں“‌ ط·ظ„ط¨ ط¬ط¯ظٹط¯\n\n`+
              `ًں†” ط§ظ„ظ…ط¹ط±ظپ: ${o.orderId}\n`+
              `ًں”§ ط§ظ„ط®ط¯ظ…ط©: ${o.serviceTitle}\n`+
              `ًں”¢ ط§ظ„ظƒظ…ظٹط©: ${o.qty.toLocaleString()}\n`+
              `ًں’° ط§ظ„طھظƒظ„ظپط©: ${o.total_lira.toLocaleString()} ظ„.ط³\n`+
              `ًں“ژ ط§ظ„ط±ط§ط¨ط·: ${o.link}\n`+
              `ًں”‘ ظƒظˆط¯ ط§ظ„طھط­ظˆظٹظ„: ${finalCode}\n`+ // ط§ط³طھط®ط¯ط§ظ… finalCode ط§ظ„ط¬ط¯ظٹط¯
              `ًں’³ ط§ظ„ط¯ظپط¹: ${paymentInfo}\n\n(طھظ… طھظ‚ط¯ظٹظ… ط§ظ„ط·ظ„ط¨ ط¹ط¨ط± ظˆط§ط¬ظ‡ط© MAZEN â€” ط§ظ„ط­ط§ظ„ط©: ${o.status})`;
  window.open(`https://wa.me/${WA_NUMBER}?text=${encodeURIComponent(msg)}`, '_blank', 'noopener');
  document.getElementById('confirmBox').style.display = 'none';
}

function openStatusChecker(){
  document.getElementById('statusChecker').style.display = 'flex';
  document.getElementById('statusChecker').setAttribute('aria-hidden','false');
  document.getElementById('statusOrderId').value = '';
  document.getElementById('statusResult').style.display = 'none';
}

function closeStatusChecker(){
  document.getElementById('statusChecker').style.display = 'none';
  document.getElementById('statusChecker').setAttribute('aria-hidden','true');
}

function checkOrderStatus(){
  const idStr = document.getElementById('statusOrderId').value.trim();
  if(!idStr){ alert('ط£ط¯ط®ظ„ ظ…ط¹ط±ظپ ط§ظ„ط·ظ„ط¨'); return; }
  const id = Number(idStr);
  const arr = JSON.parse(localStorage.getItem('mazen_orders') || '[]');
  const o = arr.find(x=>x.orderId === id);
  const resultEl = document.getElementById('statusResult');
  
  resultEl.style.display = 'block';
  
  if(!o){
    resultEl.style.background = 'rgba(255,0,0,0.12)';
    resultEl.style.borderColor = 'rgba(255,0,0,0.28)';
    resultEl.innerHTML = `<div style="color:var(--muted)">ظ„ظ… ظ†طھظ…ظƒظ† ظ…ظ† ط§ظ„ط¹ط«ظˆط± ط¹ظ„ظ‰ ط·ظ„ط¨ ط¨ط§ظ„ظ…ط¹ط±ظپ: <strong>${esc(idStr)}</strong></div>`;
    return;
  }
  
  resultEl.style.background = 'rgba(43,130,255,0.1)';
  resultEl.style.borderColor = 'rgba(43,130,255,0.3)';
  resultEl.innerHTML = `
    <div style="text-align:right;line-height:1.8">
      <div><b>ط§ظ„ظ…ط¹ط±ظپ:</b> ${o.orderId}</div>
      <div><b>ط§ظ„ط®ط¯ظ…ط©:</b> ${esc(o.serviceTitle)}</div>
      <div><b>ط§ظ„ظƒظ…ظٹط©:</b> ${o.qty.toLocaleString()}</div>
      <div><b>ط§ظ„طھظƒظ„ظپط©:</b> ${o.total_lira.toLocaleString()} ظ„.ط³</div>
      <div><b>ط§ظ„ط­ط§ظ„ط©:</b> <strong style="color:var(--accent-cta);">${o.status}</strong></div>
      <div><b>طھط§ط±ظٹط® ط§ظ„ط·ظ„ط¨:</b> ${new Date(o.created_at).toLocaleString()}</div>
    </div>
    <div style="margin-top:12px">
      <button onclick="sendWA(${o.orderId})" class="btn btn-wa" style="padding:9px 12px;border-radius:10px;width:100%;">ط¥ط±ط³ط§ظ„ ط§ظ„طھظپط§طµظٹظ„ ط¥ظ„ظ‰ ظˆط§طھط³ط§ط¨</button>
    </div>
  `;
}

document.addEventListener('click', (e)=>{
  const confirmBox = document.getElementById('confirmBox');
  if(confirmBox.style.display === 'flex' && e.target === confirmBox) confirmBox.style.display = 'none';
  const statusBox = document.getElementById('statusChecker');
  if(statusBox.style.display === 'flex' && e.target === statusBox) closeStatusChecker();
  const orderBox = document.getElementById('orderModal');
  if(orderBox.style.display === 'flex' && e.target === orderBox) closeOrder();
});
document.addEventListener('keydown', e=>{
  if(e.key === 'Escape'){
    if(document.getElementById('confirmBox').style.display === 'flex') document.getElementById('confirmBox').style.display = 'none';
    else if(document.getElementById('statusChecker').style.display === 'flex') closeStatusChecker();
    else closeOrder();
  }
});

const EFFECTS = { snow:false, particles:true, cursorGlow:true, tilt:true, neonLines:true };

const cursorEl = document.getElementById('cursorFollow');
if(EFFECTS.cursorGlow){
  document.addEventListener('mousemove', (e)=>{
    cursorEl.style.left = e.clientX + 'px';
    cursorEl.style.top = e.clientY + 'px';
    cursorEl.style.width = '24px'; cursorEl.style.height = '24px';
  });
  document.addEventListener('mousedown', ()=>{ cursorEl.style.transform = 'translate(-50%,-50%) scale(.8)'; });
  document.addEventListener('mouseup', ()=>{ cursorEl.style.transform = 'translate(-50%,-50%) scale(1)'; });
} else cursorEl.style.display = 'none';

(function ParticleSystem(){
  if(!EFFECTS.particles) return;
  const canvas = document.getElementById('particleCanvas');
  const ctx = canvas.getContext('2d');
  let w = canvas.width = window.innerWidth;
  let h = canvas.height = window.innerHeight;
  const particles = [];
  const COUNT = Math.max(30, Math.floor(w/60));
  for(let i=0;i<COUNT;i++){
    particles.push({
      x: Math.random()*w, y: Math.random()*h, r: 0.6 + Math.random()*1.6,
      vx: (Math.random()*0.6)-0.3, vy: (Math.random()*0.2)+0.05, a: 0.05 + Math.random()*0.2
    });
  }
  window.addEventListener('resize', ()=>{ w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; });
  let t=0;
  function loop(){
    ctx.clearRect(0,0,w,h);
    for(const p of particles){
      p.x += p.vx + Math.sin((t+p.x)/200)*0.2;
      p.y += p.vy;
      if(p.y > h + 5){ p.y = -10; p.x = Math.random()*w; }
      ctx.beginPath();
      ctx.fillStyle = `rgba(255,255,255,${p.a})`;
      ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
      ctx.fill();
    }
    t++;
    requestAnimationFrame(loop);
  }
  loop();
})();

(function SnowSparkles(){
  if(!EFFECTS.snow) return;
  const canvas = document.getElementById('snowCanvas');
  const ctx = canvas.getContext('2d');
  let w = canvas.width = window.innerWidth;
  let h = canvas.height = window.innerHeight;
  const flakes = [];
  const COUNT = Math.max(40, Math.floor(w/40));
  for(let i=0;i<COUNT;i++){
    flakes.push({ x: Math.random()*w, y: Math.random()*h, r: Math.random()*1.6+0.6, vy: 0.15 + Math.random()*0.5, vx: (Math.random()*0.4)-0.2, alpha: 0.35 + Math.random()*0.5 });
  }
  window.addEventListener('resize', ()=>{ w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; });
  function draw(){
    ctx.clearRect(0,0,w,h);
    for(const f of flakes){
      f.x += f.vx + Math.sin(f.y/80)*0.1;
      f.y += f.vy;
      if(f.y > h + 5){ f.y = -10; f.x = Math.random()*w; }
      ctx.beginPath();
      ctx.fillStyle = `rgba(255,255,255,${f.alpha})`;
      ctx.arc(f.x, f.y, f.r, 0, Math.PI*2);
      ctx.fill();
      if(Math.random() > 0.997){
        ctx.beginPath();
        ctx.fillStyle = 'rgba(255,255,255,0.9)';
        ctx.arc(f.x + (Math.random()*6-3), f.y + (Math.random()*6-3), f.r*0.8, 0, Math.PI*2);
        ctx.fill();
      }
    }
    requestAnimationFrame(draw);
  }
  draw();
})();

const header = document.getElementById('siteHeader');
window.addEventListener('scroll', ()=>{ const s = window.scrollY; if(s > 30) header.classList.add('scrolled'); else header.classList.remove('scrolled'); });

function showSkeletonThenLoad(){
  document.getElementById('skeletonArea').style.display = 'grid';
  document.getElementById('servicesContainer').style.display = 'none';
  setTimeout(()=>{
    document.getElementById('skeletonArea').style.display = 'none';
    document.getElementById('servicesContainer').style.display = 'grid';
    buildCategories();
    renderServices();
  }, 700);
}
showSkeletonThenLoad();

let currentTheme = 'dark';
document.getElementById('themeToggle').addEventListener('click', ()=>{
  if(currentTheme === 'dark'){
    document.documentElement.style.setProperty('--bg','#f6f8fb');
    document.documentElement.style.setProperty('--panel','#ffffff');
    document.documentElement.style.setProperty('--muted','#556677');
    document.documentElement.style.setProperty('--text','#071122');
    document.documentElement.style.setProperty('--card-bg','#ffffff');
    document.documentElement.style.setProperty('--border-color','rgba(0,0,0,0.1)');
    document.getElementById('themeToggle').innerText = 'âک€ï¸ڈ';
    currentTheme = 'light';
  } else {
    location.reload();
  }
});

</script>
</body>
</html>
